<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School ERP - Teacher & Class Management</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #FFFFFF;
            color: #1E1E1E;
            line-height: 1.5;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            padding-bottom: 24px;
            border-bottom: 1px solid #E0E0E0;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: #7B54FA;
        }

        .view-toggle {
            display: flex;
            background: #F7F7F7;
            border-radius: 8px;
            padding: 4px;
        }

        .toggle-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .toggle-btn.active {
            background: #7B54FA;
            color: white;
            box-shadow: 0 2px 4px rgba(123, 84, 250, 0.2);
        }

        .toggle-btn:not(.active) {
            color: #606060;
        }

        .toggle-btn:hover:not(.active) {
            background: #E0E0E0;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .section-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 24px;
            color: #1E1E1E;
        }

        /* Option 1: Interactive Network View */
        .network-container {
            background: #F7F7F7;
            border-radius: 12px;
            padding: 32px;
            margin-bottom: 32px;
            position: relative;
            overflow: hidden;
        }

        .network-view {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            min-height: 400px;
            position: relative;
        }

        .node-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }

        .node-group h3 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 24px;
            color: #7B54FA;
        }

        .node {
            background: white;
            border: 2px solid #E0E0E0;
            border-radius: 12px;
            padding: 16px;
            margin: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            min-width: 140px;
            text-align: center;
        }

        .schedule-grid-node {
            min-width: 180px;
            transition: all 0.3s ease;
        }

        .schedule-grid-node.expanded {
            min-width: 220px;
            padding: 20px;
        }

        .schedule-grid-column {
            transition: all 0.3s ease;
        }

        .schedule-grid-column.hidden {
            opacity: 0;
            transform: translateX(-20px);
            pointer-events: none;
            width: 0;
            margin: 0;
            overflow: hidden;
        }

        .node:hover {
            border-color: #7B54FA;
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(123, 84, 250, 0.15);
        }

        .node.selected {
            border-color: #7B54FA;
            background: #7B54FA;
            color: white;
        }

        .node-title {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .node-subtitle {
            font-size: 12px;
            color: #606060;
        }

        .node.selected .node-subtitle {
            color: rgba(255,255,255,0.8);
        }

        .node-info {
            font-size: 10px;
            color: #7B54FA;
            font-weight: 500;
            margin-top: 4px;
        }

        .node.selected .node-info {
            color: rgba(255,255,255,0.9);
        }

        .warning-indicator {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 20px;
            height: 20px;
            background: #FFC107;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            color: white;
        }

        .error-indicator {
            background: #DC3545;
        }

        .success-indicator {
            background: #28A745;
        }

        .unassigned {
            border-color: #FFC107;
            background: #FFF9E6;
        }

        .overloaded {
            border-color: #DC3545;
            background: #FFE6E6;
        }

        .underloaded {
            border-color: #FFC107;
            background: #FFF9E6;
        }

        .connection-line {
            position: absolute;
            height: 2px;
            background: #7B54FA;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1;
        }

        .connection-line.active {
            opacity: 1;
        }

        /* Option 2: Card-based Grid View */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .class-card, .teacher-card {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        .class-card:hover, .teacher-card:hover {
            border-color: #7B54FA;
            box-shadow: 0 4px 16px rgba(123, 84, 250, 0.15);
        }

        .card-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 16px;
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            color: #1E1E1E;
        }

        .edit-btn {
            background: #F7F7F7;
            border: none;
            border-radius: 8px;
            padding: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .edit-btn:hover {
            background: #7B54FA;
            color: white;
        }

        .subject-list {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .subject-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 16px;
            margin-bottom: 12px;
            background: #FAFAFA;
            border: 1px solid #F0F0F0;
            border-radius: 10px;
            transition: all 0.2s ease;
        }

        .subject-item:hover {
            background: #F7F7F7;
            border-color: #E0E0E0;
            transform: translateY(-1px);
        }

        .subject-item:last-child {
            margin-bottom: 0;
        }

        .subject-item.overloaded {
            border-color: #FFB3B3;
            background: #FFF5F5;
        }

        .subject-item.unassigned {
            border: 2px dashed #FFC107;
            background: #FFFBF0;
        }

        .subject-left {
            display: flex;
            flex-direction: column;
            gap: 8px;
            flex: 1;
        }

        .subject-name {
            font-weight: 600;
            font-size: 16px;
            color: #1E1E1E;
            margin: 0;
        }

        .subject-meta {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .teacher-info {
            display: flex;
            flex-direction: column;
            gap: 6px;
            align-items: flex-end;
            text-align: right;
        }

        .teacher-name {
            font-size: 13px;
            font-weight: 500;
            color: #1E1E1E;
            background: #E8F4FD;
            padding: 6px 10px;
            border-radius: 20px;
            border: 1px solid #D1E7F8;
        }

        .teacher-name.overloaded {
            background: #FFE6E6;
            color: #DC3545;
            border-color: #FFB3B3;
        }

        .assistant-name {
            font-size: 11px;
            font-weight: 500;
            color: #7B54FA;
            background: #F0EBFF;
            padding: 4px 8px;
            border-radius: 12px;
            border: 1px solid #E0D4FF;
        }

        .assistant-name.unassigned {
            background: #FFF9E6;
            color: #B8860B;
            border-color: #F0E68C;
        }

        .time-slot {
            font-size: 12px;
            color: #7B54FA;
            font-weight: 500;
            background: #F8F6FF;
            padding: 4px 8px;
            border-radius: 8px;
            border: 1px solid #E8E0FF;
        }

        .extra-periods {
            background: #DC3545;
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 8px;
        }

        .missing-periods {
            background: #FFC107;
            color: white;
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 8px;
        }

        .time-slot {
            font-size: 12px;
            color: #7B54FA;
            font-weight: 500;
        }

        /* Option 3: Timeline/Schedule View */
        .schedule-container {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 32px;
        }

        .schedule-header {
            background: #F7F7F7;
            padding: 16px 24px;
            border-bottom: 1px solid #E0E0E0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .schedule-grid {
            display: grid;
            grid-template-columns: 100px repeat(7, 1fr);
            gap: 1px;
            background: #E0E0E0;
        }

        .time-header, .day-header {
            background: #F7F7F7;
            padding: 12px;
            font-weight: 600;
            font-size: 14px;
            text-align: center;
            color: #606060;
        }

        .schedule-cell {
            background: white;
            padding: 8px;
            min-height: 60px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .schedule-cell:hover {
            background: #F7F7F7;
        }

        .schedule-cell.occupied {
            background: #7B54FA;
            color: white;
        }

        .schedule-cell.occupied:hover {
            background: #6B46E5;
        }

        .schedule-cell.available {
            background: #F7F7F7;
            border: 2px dashed #E0E0E0;
        }

        .schedule-cell.available:hover {
            background: #F0EBFF;
            border-color: #7B54FA;
        }

        .schedule-cell.warning {
            border: 2px solid #FFC107;
        }

        .schedule-cell.error {
            border: 2px solid #DC3545;
        }

        .cell-subject {
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .cell-teacher {
            font-size: 10px;
            opacity: 0.8;
        }

        /* Modal for editing */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #606060;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-weight: 500;
            margin-bottom: 8px;
            color: #1E1E1E;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 12px;
            border: 1px solid #E0E0E0;
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            transition: border-color 0.2s ease;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #7B54FA;
        }

        .btn-primary {
            background: #7B54FA;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-primary:hover {
            background: #6B46E5;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #F7F7F7;
            color: #606060;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-right: 8px;
        }

        .btn-secondary:hover {
            background: #E0E0E0;
        }

        /* Schedule Grid Modal */
        .schedule-grid-modal {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            margin: 16px 0;
        }

        .day-label {
            font-weight: 600;
            font-size: 12px;
            color: #606060;
            text-align: center;
            padding: 8px 4px;
        }

        .period-cell {
            aspect-ratio: 1;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 12px;
            font-weight: 600;
        }

        .period-cell:hover {
            border-color: #7B54FA;
        }

        .period-cell.assigned {
            background: #7B54FA;
            color: white;
            border-color: #7B54FA;
        }

        .period-cell.available {
            background: #F7F7F7;
            border-color: #28A745;
        }

        .period-cell.conflict {
            background: #FFE6E6;
            border-color: #DC3545;
        }

        .assignment-actions {
            display: flex;
            gap: 8px;
            margin-top: 16px;
        }

        /* Inline Assignment Styles */
        .inline-assignment {
            position: absolute;
            z-index: 100;
            background: white;
            border: 2px solid #7B54FA;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(123, 84, 250, 0.2);
            min-width: 320px;
            max-width: 400px;
            margin-top: 8px;
            animation: slideInDown 0.3s ease-out;
        }

        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideOutUp {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(-10px);
            }
        }

        .inline-assignment-content {
            padding: 16px;
        }

        .inline-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid #E0E0E0;
        }

        .inline-header h4 {
            font-size: 16px;
            font-weight: 600;
            color: #7B54FA;
            margin: 0;
        }

        .close-inline-btn {
            background: none;
            border: none;
            font-size: 20px;
            color: #606060;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .close-inline-btn:hover {
            background: #F7F7F7;
            color: #7B54FA;
        }

        .inline-label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: #606060;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .inline-subjects, .inline-assignments, .inline-unassigned {
            margin-bottom: 16px;
        }

        .inline-subject-item, .inline-assignment-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: #F7F7F7;
            border-radius: 8px;
            margin-bottom: 6px;
            font-size: 14px;
        }

        .inline-unassigned-item {
            padding: 8px 12px;
            background: #FFF9E6;
            border: 1px solid #FFC107;
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .inline-unassigned-item span {
            display: block;
            font-weight: 500;
            margin-bottom: 8px;
            color: #1E1E1E;
        }

        .inline-form-row {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .inline-add-subject {
            margin-bottom: 16px;
        }

        .inline-select {
            flex: 1;
            padding: 6px 8px;
            border: 1px solid #E0E0E0;
            border-radius: 6px;
            font-size: 12px;
            font-family: 'Inter', sans-serif;
            background: white;
        }

        .inline-select:focus {
            outline: none;
            border-color: #7B54FA;
        }

        .inline-assign-btn {
            background: #28A745;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .inline-assign-btn:hover {
            background: #218838;
            transform: translateY(-1px);
        }

        .inline-reassign-btn {
            background: #FFC107;
            color: #1E1E1E;
            border: none;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .inline-reassign-btn:hover {
            background: #E0A800;
        }

        .inline-schedule-btn {
            background: #7B54FA;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
        }

        .inline-schedule-btn:hover {
            background: #6B46E5;
        }

        .inline-actions {
            border-top: 1px solid #E0E0E0;
            padding-top: 12px;
        }

        /* Position inline assignment relative to nodes */
        .node-group {
            position: relative;
        }

        .mini-schedule-grid {
            display: flex;
            flex-direction: column;
            gap: 2px;
            margin: 8px 0;
        }

        .mini-grid-row {
            display: flex;
            gap: 2px;
        }

        .mini-cell {
            width: 20px;
            height: 16px;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 600;
            cursor: pointer;
        }

        .mini-cell.assigned {
            background: #7B54FA;
            color: white;
        }

        .mini-cell.available {
            background: #E0E0E0;
            color: #606060;
        }

        .mini-cell.conflict {
            background: #DC3545;
            color: white;
        }

        .schedule-grid-node {
            min-width: 140px;
        }

        .quick-assign-btn {
            background: #28A745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quick-assign-btn:hover {
            background: #218838;
        }

        .reassign-btn {
            background: #FFC107;
            color: #1E1E1E;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .reassign-btn:hover {
            background: #E0A800;
        }

        .options-nav {
            display: flex;
            gap: 16px;
            margin-bottom: 32px;
            border-bottom: 1px solid #E0E0E0;
        }

        .option-tab {
            padding: 12px 0;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            font-weight: 500;
            color: #606060;
            transition: all 0.2s ease;
        }

        .option-tab.active {
            color: #7B54FA;
            border-bottom-color: #7B54FA;
        }

        .option-content {
            display: none;
        }

        .option-content.active {
            display: block;
        }

        /* Teacher Schedule Styles */
        .teacher-schedule-container {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 32px;
        }

        .teacher-schedule-header {
            background: #F7F7F7;
            padding: 16px 24px;
            border-bottom: 1px solid #E0E0E0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .schedule-controls {
            display: flex;
            gap: 8px;
        }

        .teacher-schedule-grid {
            display: grid;
            grid-template-columns: 150px repeat(5, 1fr) 80px;
            gap: 1px;
            background: #E0E0E0;
        }

        .teacher-name-header, .workload-header {
            background: #F7F7F7;
            padding: 12px;
            font-weight: 600;
            font-size: 14px;
            text-align: center;
            color: #606060;
        }

        .teacher-name-cell {
            background: white;
            padding: 12px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .teacher-name-cell.overloaded {
            background: #FFE6E6;
            border-left: 4px solid #DC3545;
        }

        .teacher-name-title {
            font-weight: 600;
            font-size: 14px;
            color: #1E1E1E;
        }

        .teacher-subject {
            font-size: 12px;
            color: #606060;
            margin-top: 2px;
        }

        .teacher-schedule-cell {
            background: white;
            padding: 8px;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .teacher-schedule-cell.occupied {
            background: #F0EBFF;
            border-left: 4px solid #7B54FA;
        }

        .teacher-schedule-cell.conflict {
            background: #FFE6E6;
            border-left: 4px solid #DC3545;
        }

        .schedule-period {
            font-size: 11px;
            background: #7B54FA;
            color: white;
            padding: 4px 6px;
            border-radius: 4px;
            text-align: center;
        }

        .teacher-schedule-cell.conflict .schedule-period {
            background: #DC3545;
        }

        .workload-cell {
            background: white;
            padding: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .workload-cell.optimal {
            background: #E8F5E8;
            color: #28A745;
        }

        .workload-cell.underloaded {
            background: #FFF9E6;
            color: #B8860B;
        }

        .workload-cell.overloaded {
            background: #FFE6E6;
            color: #DC3545;
        }

        .workload-hours {
            font-size: 16px;
            font-weight: 600;
        }

        .workload-status {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Workload Analysis Styles */
        .workload-analysis-container {
            padding: 24px;
        }

        .workload-summary {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
            margin-bottom: 32px;
        }

        .workload-card {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
        }

        .workload-card.optimal {
            border-color: #28A745;
            background: #E8F5E8;
        }

        .workload-card.underloaded {
            border-color: #FFC107;
            background: #FFF9E6;
        }

        .workload-card.overloaded {
            border-color: #DC3545;
            background: #FFE6E6;
        }

        .workload-number {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .workload-label {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .workload-teachers {
            font-size: 14px;
            color: #606060;
        }

        .workload-charts {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 32px;
        }

        .workload-chart {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            padding: 24px;
        }

        .chart-bars {
            display: flex;
            justify-content: space-around;
            align-items: end;
            height: 200px;
            margin-top: 16px;
        }

        .chart-bar {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 60px;
        }

        .bar-fill {
            width: 100%;
            border-radius: 4px 4px 0 0;
            margin-bottom: 8px;
        }

        .bar-fill.optimal {
            background: #28A745;
        }

        .bar-fill.underloaded {
            background: #FFC107;
        }

        .bar-fill.overloaded {
            background: #DC3545;
        }

        .bar-label {
            font-size: 10px;
            text-align: center;
            color: #606060;
        }

        .efficiency-metrics {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            padding: 24px;
        }

        .metric-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #F0F0F0;
        }

        .metric-item:last-child {
            border-bottom: none;
        }

        .metric-label {
            font-size: 14px;
            color: #606060;
        }

        .metric-value {
            font-weight: 600;
            font-size: 14px;
        }

        .metric-value.warning {
            color: #FFC107;
        }

        .metric-value.success {
            color: #28A745;
        }

        /* Subject Card Styles */
        .subject-card {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        .subject-card:hover {
            border-color: #7B54FA;
            box-shadow: 0 4px 16px rgba(123, 84, 250, 0.15);
        }

        .subject-card.optimal {
            border-color: #28A745;
            background: linear-gradient(135deg, #E8F5E8 0%, #FFFFFF 100%);
        }

        .subject-card.warning {
            border-color: #FFC107;
            background: linear-gradient(135deg, #FFF9E6 0%, #FFFFFF 100%);
        }

        .subject-card.critical {
            border-color: #DC3545;
            background: linear-gradient(135deg, #FFE6E6 0%, #FFFFFF 100%);
        }

        .subject-status-badge {
            font-size: 12px;
            font-weight: 600;
            padding: 4px 12px;
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .subject-status-badge.optimal {
            background: #28A745;
            color: white;
        }

        .subject-status-badge.warning {
            background: #FFC107;
            color: #1E1E1E;
        }

        .subject-status-badge.critical {
            background: #DC3545;
            color: white;
        }

        .subject-stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            display: block;
            font-size: 32px;
            font-weight: 700;
            color: #7B54FA;
        }

        .stat-label {
            font-size: 12px;
            color: #606060;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .subject-teacher-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #F0F0F0;
        }

        .primary-teacher, .assistant-teacher {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .primary-teacher.overloaded {
            color: #DC3545;
        }

        .assistant-teacher.unassigned {
            color: #FFC107;
        }

        .teacher-badge {
            font-size: 10px;
            font-weight: 600;
            padding: 4px 6px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .teacher-badge.pt {
            background: #7B54FA;
            color: white;
        }

        .teacher-badge.at {
            background: #28A745;
            color: white;
        }

        /* Coverage Matrix Styles */
        .coverage-matrix {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 32px;
        }

        .coverage-grid {
            display: grid;
            grid-template-columns: 120px repeat(4, 1fr);
            gap: 1px;
            background: #E0E0E0;
            border-radius: 8px;
            overflow: hidden;
            margin-top: 16px;
        }

        .coverage-header, .subject-row-header {
            background: #F7F7F7;
            padding: 12px;
            font-weight: 600;
            font-size: 14px;
            text-align: center;
            color: #606060;
        }

        .coverage-cell {
            background: white;
            padding: 12px;
            text-align: center;
            font-size: 12px;
        }

        .coverage-cell.assigned {
            background: #E8F5E8;
            color: #28A745;
        }

        .coverage-cell.unassigned {
            background: #FFF9E6;
            color: #B8860B;
        }

        .coverage-cell.conflict {
            background: #FFE6E6;
            color: #DC3545;
        }

        .coverage-percentage {
            background: white;
            padding: 12px;
            text-align: center;
            font-weight: 600;
            font-size: 16px;
        }

        .coverage-percentage.optimal {
            background: #E8F5E8;
            color: #28A745;
        }

        .coverage-percentage.warning {
            background: #FFF9E6;
            color: #B8860B;
        }

        .coverage-percentage.critical {
            background: #FFE6E6;
            color: #DC3545;
        }

        /* Analytics Dashboard Styles */
        .analytics-dashboard {
            padding: 24px;
        }

        .analytics-summary {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
            margin-bottom: 32px;
        }

        .analytics-card {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
        }

        .analytics-number {
            font-size: 48px;
            font-weight: 700;
            color: #7B54FA;
            margin-bottom: 8px;
        }

        .analytics-label {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #1E1E1E;
        }

        .analytics-trend {
            font-size: 14px;
            color: #606060;
        }

        .analytics-trend.warning {
            color: #FFC107;
        }

        .analytics-trend.critical {
            color: #DC3545;
        }

        .subject-performance-chart {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            padding: 24px;
        }

        .performance-bars {
            margin-top: 16px;
        }

        .performance-item {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }

        .performance-label {
            width: 100px;
            font-size: 14px;
            font-weight: 500;
            color: #1E1E1E;
        }

        .performance-bar {
            flex: 1;
            height: 20px;
            background: #F0F0F0;
            border-radius: 10px;
            margin: 0 16px;
            overflow: hidden;
        }

        .performance-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .performance-fill.optimal {
            background: #28A745;
        }

        .performance-fill.warning {
            background: #FFC107;
        }

        .performance-fill.critical {
            background: #DC3545;
        }

        .performance-score {
            width: 50px;
            text-align: right;
            font-weight: 600;
            font-size: 14px;
            color: #1E1E1E;
        }

        /* Graph Analytics Styles */
        .graph-analytics-container {
            padding: 24px;
        }

        .graph-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .graph-controls {
            display: flex;
            align-items: center;
        }

        .graph-view {
            display: none;
        }

        .graph-view.active {
            display: block;
        }

        .graph-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 32px;
            align-items: start;
        }

        .graph-visualization {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            padding: 24px;
        }

        .graph-insights {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            padding: 24px;
        }

        .insight-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 16px;
            padding: 12px;
            border-radius: 8px;
        }

        .insight-item.critical {
            background: #FFE6E6;
        }

        .insight-item.warning {
            background: #FFF9E6;
        }

        .insight-item.success {
            background: #E8F5E8;
        }

        .insight-item.info {
            background: #E8F4FD;
        }

        .insight-icon {
            font-size: 16px;
            margin-top: 2px;
        }

        .insight-text {
            font-size: 14px;
            line-height: 1.4;
        }

        .coverage-donut-chart {
            display: flex;
            justify-content: center;
            align-items: center;
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            padding: 24px;
        }

        .coverage-legend {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            padding: 24px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
            font-size: 14px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }

        .efficiency-metrics-visual {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            align-items: start;
        }

        .efficiency-gauge {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            padding: 24px;
            display: flex;
            justify-content: center;
        }

        .efficiency-breakdown {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            padding: 24px;
        }

        .breakdown-item {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }

        .breakdown-label {
            width: 120px;
            font-size: 12px;
            color: #606060;
        }

        .breakdown-bar {
            flex: 1;
            height: 8px;
            background: #F0F0F0;
            border-radius: 4px;
            margin: 0 12px;
            overflow: hidden;
        }

        .breakdown-fill {
            height: 100%;
            border-radius: 4px;
        }

        .breakdown-value {
            width: 40px;
            text-align: right;
            font-size: 12px;
            font-weight: 600;
        }

        .network-visualization {
            background: white;
            border: 1px solid #E0E0E0;
            border-radius: 12px;
            padding: 24px;
        }

        @media (max-width: 768px) {
            .network-view {
                flex-direction: column;
                align-items: center;
            }
            
            .schedule-grid {
                grid-template-columns: 80px repeat(5, 1fr);
                font-size: 12px;
            }
            
            .grid-container {
                grid-template-columns: 1fr;
            }

            .teacher-schedule-grid {
                grid-template-columns: 120px repeat(3, 1fr) 60px;
                font-size: 12px;
            }

            .workload-summary, .analytics-summary {
                grid-template-columns: 1fr;
            }

            .workload-charts, .graph-content, .efficiency-metrics-visual {
                grid-template-columns: 1fr;
            }

            .coverage-grid {
                grid-template-columns: 100px repeat(2, 1fr) 80px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">Simflo ERP</div>
            <div class="view-toggle">
                <button class="toggle-btn active" onclick="switchView('class')">Class View</button>
                <button class="toggle-btn" onclick="switchView('teacher')">Teacher View</button>
                <button class="toggle-btn" onclick="switchView('subject')">Subject View</button>
            </div>
        </div>

        <!-- Class View Section -->
        <div id="class-view" class="content-section active">
            <h2 class="section-title">Class Management - Multiple UI Options</h2>
            
            <div class="options-nav">
                <div class="option-tab active" onclick="switchOption('network')">Network View</div>
                <div class="option-tab" onclick="switchOption('cards')">Card Grid</div>
                <div class="option-tab" onclick="switchOption('schedule')">Schedule View</div>
                <div class="option-tab" onclick="switchOption('graph')">Graph Analytics</div>
                <div class="schedule-toggle" style="margin-left: auto;">
                    <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; color: #606060;">
                        <input type="checkbox" id="schedule-grid-toggle" checked onchange="toggleScheduleGrid()" style="margin: 0;">
                        Show Schedule Grid
                    </label>
                </div>
            </div>

            <!-- Option 1: Network/Mind Map View -->
            <div id="network-option" class="option-content active">
                <div class="network-container">
                    <div class="network-view">
                        <div class="node-group">
                            <h3>Classes</h3>
                            <div class="node" onclick="selectNode(this, 'class', 'Class 10A')">
                                <div class="node-title">Class 10A</div>
                                <div class="node-subtitle">30 Students</div>
                                <div class="node-info">3 subjects assigned</div>
                            </div>
                            <div class="node underloaded" onclick="selectNode(this, 'class', 'Class 10B')" style="position: relative;">
                                <div class="warning-indicator">!</div>
                                <div class="node-title">Class 10B</div>
                                <div class="node-subtitle">28 Students</div>
                                <div class="node-info">2 subjects (need 4)</div>
                            </div>
                            <div class="node underloaded" onclick="selectNode(this, 'class', 'Class 9A')" style="position: relative;">
                                <div class="warning-indicator">!</div>
                                <div class="node-title">Class 9A</div>
                                <div class="node-subtitle">32 Students</div>
                                <div class="node-info">2 subjects (need 3)</div>
                            </div>
                        </div>

                        <div class="node-group">
                            <h3>Subjects</h3>
                            <div class="node subject-node" data-subject="Mathematics" onclick="selectNode(this, 'subject', 'Mathematics')">
                                <div class="node-title">Mathematics</div>
                                <div class="node-subtitle">Core Subject</div>
                                <div class="node-info">3 classes assigned</div>
                            </div>
                            <div class="node subject-node underloaded" data-subject="Physics" onclick="selectNode(this, 'subject', 'Physics')" style="position: relative;" title="Physics needs 1 more class assignment">
                                <div class="warning-indicator">!</div>
                                <div class="node-title">Physics</div>
                                <div class="node-subtitle">Science</div>
                                <div class="node-info">2 classes (-1 needed)</div>
                            </div>
                            <div class="node subject-node underloaded" data-subject="English" onclick="selectNode(this, 'subject', 'English')" style="position: relative;" title="English needs 1 more class assignment">
                                <div class="warning-indicator">!</div>
                                <div class="node-title">English</div>
                                <div class="node-subtitle">Language</div>
                                <div class="node-info">2 classes (-1 needed)</div>
                            </div>
                            <div class="node subject-node unassigned" data-subject="Chemistry" onclick="selectNode(this, 'subject', 'Chemistry')" style="position: relative;" title="Chemistry critically understaffed - needs 1 more class">
                                <div class="error-indicator">⚠</div>
                                <div class="node-title">Chemistry</div>
                                <div class="node-subtitle">Science</div>
                                <div class="node-info">1 class (-1 needed)</div>
                            </div>
                        </div>

                        <div class="node-group">
                            <h3>Teachers</h3>
                            <div class="node schedule-grid-node" onclick="openScheduleModal('Mathematics')" style="cursor: pointer;" title="Mathematics schedule across all classes - Click to manage">
                                <div class="node-title">Mathematics</div>
                                <div class="mini-schedule-grid">
                                    <div class="mini-grid-row">
                                        <div class="mini-cell assigned" title="Mon 9:00 - Class 10A">M</div>
                                        <div class="mini-cell assigned" title="Tue 9:00 - Class 9A">T</div>
                                        <div class="mini-cell assigned" title="Wed 11:00 - Class 10A">W</div>
                                        <div class="mini-cell available" title="Thu - Available for assignment">T</div>
                                        <div class="mini-cell available" title="Fri - Available for assignment">F</div>
                                    </div>
                                    <div class="mini-grid-row">
                                        <div class="mini-cell assigned" title="Mon 10:00 - Class 10B">M</div>
                                        <div class="mini-cell available" title="Tue 10:00 - Available">T</div>
                                        <div class="mini-cell available" title="Wed 10:00 - Available">W</div>
                                        <div class="mini-cell available" title="Thu 10:00 - Available">T</div>
                                        <div class="mini-cell available" title="Fri 10:00 - Available">F</div>
                                    </div>
                                </div>
                                <div class="node-info">3 classes assigned</div>
                            </div>
                            
                            <div class="node schedule-grid-node underloaded" onclick="openScheduleModal('Physics')" style="cursor: pointer; position: relative;" title="Physics needs 1 more class assignment - Click to manage">
                                <div class="warning-indicator" title="Physics is underloaded - needs 1 more class">!</div>
                                <div class="node-title">Physics</div>
                                <div class="mini-schedule-grid">
                                    <div class="mini-grid-row">
                                        <div class="mini-cell available" title="Mon - Available for assignment">M</div>
                                        <div class="mini-cell assigned" title="Tue 10:00 - Class 10A">T</div>
                                        <div class="mini-cell assigned" title="Wed 10:00 - Class 9A">W</div>
                                        <div class="mini-cell available" title="Thu - Available for assignment">T</div>
                                        <div class="mini-cell assigned" title="Fri 9:00 - Class 10A">F</div>
                                    </div>
                                    <div class="mini-grid-row">
                                        <div class="mini-cell available" title="Mon 10:00 - Available">M</div>
                                        <div class="mini-cell available" title="Tue 11:00 - Available">T</div>
                                        <div class="mini-cell available" title="Wed 11:00 - Available">W</div>
                                        <div class="mini-cell available" title="Thu 11:00 - Available">T</div>
                                        <div class="mini-cell available" title="Fri 11:00 - Available">F</div>
                                    </div>
                                </div>
                                <div class="node-info">2 classes (-1 needed)</div>
                            </div>
                            
                            <div class="node schedule-grid-node underloaded" onclick="openScheduleModal('English')" style="cursor: pointer; position: relative;" title="English needs 1 more class assignment - Click to manage">
                                <div class="warning-indicator" title="English is underloaded - needs 1 more class">!</div>
                                <div class="node-title">English</div>
                                <div class="mini-schedule-grid">
                                    <div class="mini-grid-row">
                                        <div class="mini-cell assigned" title="Mon 11:00 - Class 10A">M</div>
                                        <div class="mini-cell available" title="Tue - Available for assignment">T</div>
                                        <div class="mini-cell assigned" title="Wed 9:00 - Class 10A">W</div>
                                        <div class="mini-cell available" title="Thu - Available for assignment">T</div>
                                        <div class="mini-cell assigned" title="Fri 11:00 - Class 10B">F</div>
                                    </div>
                                    <div class="mini-grid-row">
                                        <div class="mini-cell available" title="Mon 10:00 - Available">M</div>
                                        <div class="mini-cell available" title="Tue 11:00 - Available">T</div>
                                        <div class="mini-cell available" title="Wed 11:00 - Available">W</div>
                                        <div class="mini-cell available" title="Thu 11:00 - Available">T</div>
                                        <div class="mini-cell available" title="Fri 10:00 - Available">F</div>
                                    </div>
                                </div>
                                <div class="node-info">2 classes (-1 needed)</div>
                            </div>
                            
                            <div class="node schedule-grid-node unassigned" onclick="openScheduleModal('Chemistry')" style="cursor: pointer; position: relative;" title="Chemistry critically understaffed - Dr. Wilson overloaded">
                                <div class="error-indicator" title="Chemistry has critical staffing issues">⚠</div>
                                <div class="node-title">Chemistry</div>
                                <div class="mini-schedule-grid">
                                    <div class="mini-grid-row">
                                        <div class="mini-cell available" title="Mon - Available for assignment">M</div>
                                        <div class="mini-cell available" title="Tue - Available for assignment">T</div>
                                        <div class="mini-cell available" title="Wed - Available for assignment">W</div>
                                        <div class="mini-cell conflict" title="Thu 10:00 - Class 10B (Dr. Wilson overloaded)">T</div>
                                        <div class="mini-cell available" title="Fri - Available for assignment">F</div>
                                    </div>
                                    <div class="mini-grid-row">
                                        <div class="mini-cell available" title="Mon 10:00 - Available">M</div>
                                        <div class="mini-cell available" title="Tue 11:00 - Available">T</div>
                                        <div class="mini-cell available" title="Wed 11:00 - Available">W</div>
                                        <div class="mini-cell available" title="Thu 11:00 - Available">T</div>
                                        <div class="mini-cell available" title="Fri 11:00 - Available">F</div>
                                    </div>
                                </div>
                                <div class="node-info">1 class (teacher overloaded)</div>
                            </div>
                        </div>

                        <div class="node-group">
                            <h3>Teachers</h3>
                            <div class="node teacher-node" data-teacher="Dr. Smith" onclick="selectNode(this, 'teacher', 'Dr. Smith')">
                                <div class="node-title">Dr. Smith</div>
                                <div class="node-subtitle">Mathematics</div>
                                <div class="node-info">3 classes, 15 hrs/week</div>
                            </div>
                            <div class="node teacher-node underloaded" data-teacher="Ms. Johnson" onclick="selectNode(this, 'teacher', 'Ms. Johnson')" style="position: relative;" title="Underloaded: Only 2 classes assigned, can take 1 more">
                                <div class="warning-indicator">!</div>
                                <div class="node-title">Ms. Johnson</div>
                                <div class="node-subtitle">Physics</div>
                                <div class="node-info">2 classes, 10 hrs/week</div>
                            </div>
                            <div class="node teacher-node underloaded" data-teacher="Mr. Brown" onclick="selectNode(this, 'teacher', 'Mr. Brown')" style="position: relative;" title="Underloaded: Only 2 classes assigned, can take 1 more">
                                <div class="warning-indicator">!</div>
                                <div class="node-title">Mr. Brown</div>
                                <div class="node-subtitle">English</div>
                                <div class="node-info">2 classes, 10 hrs/week</div>
                            </div>
                            <div class="node teacher-node overloaded" data-teacher="Dr. Wilson" onclick="selectNode(this, 'teacher', 'Dr. Wilson')" style="position: relative;" title="Overloaded: 5 classes assigned, 2 over limit">
                                <div class="error-indicator">⚠</div>
                                <div class="node-title">Dr. Wilson</div>
                                <div class="node-subtitle">Chemistry, Biology</div>
                                <div class="node-info">5 classes (+2), 25 hrs/week</div>
                            </div>
                        </div>

                        <div class="node-group">
                            <h3>Assistant Teachers</h3>
                            <div class="node teacher-node" data-teacher="Ms. Davis" onclick="selectNode(this, 'assistant', 'Ms. Davis')">
                                <div class="node-title">Ms. Davis</div>
                                <div class="node-subtitle">Math Assistant</div>
                                <div class="node-info">2 classes, 8 hrs/week</div>
                            </div>
                            <div class="node teacher-node underloaded" data-teacher="Mr. Taylor" onclick="selectNode(this, 'assistant', 'Mr. Taylor')" style="position: relative;" title="Available for more assignments">
                                <div class="warning-indicator">!</div>
                                <div class="node-title">Mr. Taylor</div>
                                <div class="node-subtitle">Science Assistant</div>
                                <div class="node-info">1 class, 4 hrs/week</div>
                            </div>
                            <div class="node teacher-node unassigned" data-teacher="Ms. Lee" onclick="selectNode(this, 'assistant', 'Ms. Lee')" style="position: relative;" title="Unassigned assistant teacher">
                                <div class="error-indicator">⚠</div>
                                <div class="node-title">Ms. Lee</div>
                                <div class="node-subtitle">Language Assistant</div>
                                <div class="node-info">0 classes assigned</div>
                            </div>
                        </div>

                        <div class="node-group schedule-grid-column" id="schedule-grid-column">
                            <h3>Schedule Grid</h3>
                            <div class="node schedule-grid-node" onclick="openScheduleModal('Mathematics')" style="cursor: pointer;" title="Mathematics schedule across all classes - Click to manage">
                                <div class="node-title">Mathematics</div>
                                <div class="mini-schedule-grid">
                                    <div class="mini-grid-row">
                                        <div class="mini-cell assigned" title="Mon 9:00 - Class 10A">M</div>
                                        <div class="mini-cell assigned" title="Tue 9:00 - Class 9A">T</div>
                                        <div class="mini-cell assigned" title="Wed 11:00 - Class 10A">W</div>
                                        <div class="mini-cell available" title="Thu - Available for assignment">T</div>
                                        <div class="mini-cell available" title="Fri - Available for assignment">F</div>
                                    </div>
                                    <div class="mini-grid-row">
                                        <div class="mini-cell assigned" title="Mon 10:00 - Class 10B">M</div>
                                        <div class="mini-cell available" title="Tue 10:00 - Available">T</div>
                                        <div class="mini-cell available" title="Wed 10:00 - Available">W</div>
                                        <div class="mini-cell available" title="Thu 10:00 - Available">T</div>
                                        <div class="mini-cell available" title="Fri 10:00 - Available">F</div>
                                    </div>
                                </div>
                                <div class="node-info">3 classes assigned</div>
                            </div>
                            
                            <div class="node schedule-grid-node underloaded" onclick="openScheduleModal('Physics')" style="cursor: pointer; position: relative;" title="Physics needs 1 more class assignment - Click to manage">
                                <div class="warning-indicator" title="Physics is underloaded - needs 1 more class">!</div>
                                <div class="node-title">Physics</div>
                                <div class="mini-schedule-grid">
                                    <div class="mini-grid-row">
                                        <div class="mini-cell available" title="Mon - Available for assignment">M</div>
                                        <div class="mini-cell assigned" title="Tue 10:00 - Class 10A">T</div>
                                        <div class="mini-cell assigned" title="Wed 10:00 - Class 9A">W</div>
                                        <div class="mini-cell available" title="Thu - Available for assignment">T</div>
                                        <div class="mini-cell assigned" title="Fri 9:00 - Class 10A">F</div>
                                    </div>
                                    <div class="mini-grid-row">
                                        <div class="mini-cell available" title="Mon 10:00 - Available">M</div>
                                        <div class="mini-cell available" title="Tue 11:00 - Available">T</div>
                                        <div class="mini-cell available" title="Wed 11:00 - Available">W</div>
                                        <div class="mini-cell available" title="Thu 11:00 - Available">T</div>
                                        <div class="mini-cell available" title="Fri 11:00 - Available">F</div>
                                    </div>
                                </div>
                                <div class="node-info">2 classes (-1 needed)</div>
                            </div>
                            
                            <div class="node schedule-grid-node underloaded" onclick="openScheduleModal('English')" style="cursor: pointer; position: relative;" title="English needs 1 more class assignment - Click to manage">
                                <div class="warning-indicator" title="English is underloaded - needs 1 more class">!</div>
                                <div class="node-title">English</div>
                                <div class="mini-schedule-grid">
                                    <div class="mini-grid-row">
                                        <div class="mini-cell assigned" title="Mon 11:00 - Class 10A">M</div>
                                        <div class="mini-cell available" title="Tue - Available for assignment">T</div>
                                        <div class="mini-cell assigned" title="Wed 9:00 - Class 10A">W</div>
                                        <div class="mini-cell available" title="Thu - Available for assignment">T</div>
                                        <div class="mini-cell assigned" title="Fri 11:00 - Class 10B">F</div>
                                    </div>
                                    <div class="mini-grid-row">
                                        <div class="mini-cell available" title="Mon 10:00 - Available">M</div>
                                        <div class="mini-cell available" title="Tue 11:00 - Available">T</div>
                                        <div class="mini-cell available" title="Wed 11:00 - Available">W</div>
                                        <div class="mini-cell available" title="Thu 11:00 - Available">T</div>
                                        <div class="mini-cell available" title="Fri 10:00 - Available">F</div>
                                    </div>
                                </div>
                                <div class="node-info">2 classes (-1 needed)</div>
                            </div>
                            
                            <div class="node schedule-grid-node unassigned" onclick="openScheduleModal('Chemistry')" style="cursor: pointer; position: relative;" title="Chemistry critically understaffed - Dr. Wilson overloaded">
                                <div class="error-indicator" title="Chemistry has critical staffing issues">⚠</div>
                                <div class="node-title">Chemistry</div>
                                <div class="mini-schedule-grid">
                                    <div class="mini-grid-row">
                                        <div class="mini-cell available" title="Mon - Available for assignment">M</div>
                                        <div class="mini-cell available" title="Tue - Available for assignment">T</div>
                                        <div class="mini-cell available" title="Wed - Available for assignment">W</div>
                                        <div class="mini-cell conflict" title="Thu 10:00 - Class 10B (Dr. Wilson overloaded)">T</div>
                                        <div class="mini-cell available" title="Fri - Available for assignment">F</div>
                                    </div>
                                    <div class="mini-grid-row">
                                        <div class="mini-cell available" title="Mon 10:00 - Available">M</div>
                                        <div class="mini-cell available" title="Tue 11:00 - Available">T</div>
                                        <div class="mini-cell available" title="Wed 11:00 - Available">W</div>
                                        <div class="mini-cell available" title="Thu 11:00 - Available">T</div>
                                        <div class="mini-cell available" title="Fri 11:00 - Available">F</div>
                                    </div>
                                </div>
                                <div class="node-info">1 class (teacher overloaded)</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Option 2: Card Grid View -->
            <div id="cards-option" class="option-content">
                <div class="grid-container">
                    <div class="class-card">
                        <div class="card-header">
                            <h3 class="card-title">Class 10A</h3>
                            <button class="edit-btn" onclick="openModal('edit-class')">✏️</button>
                        </div>
                        <ul class="subject-list">
                            <li class="subject-item">
                                <div class="subject-left">
                                    <div class="subject-name">Mathematics</div>
                                    <div class="subject-meta">
                                        <div class="time-slot">Mon 9:00-10:00</div>
                                    </div>
                                </div>
                                <div class="teacher-info">
                                    <span class="teacher-name">Dr. Smith</span>
                                    <span class="assistant-name">Ms. Davis</span>
                                </div>
                            </li>
                            <li class="subject-item">
                                <div class="subject-left">
                                    <div class="subject-name">Physics</div>
                                    <div class="subject-meta">
                                        <div class="time-slot">Tue 10:00-11:00</div>
                                    </div>
                                </div>
                                <div class="teacher-info">
                                    <span class="teacher-name">Ms. Johnson</span>
                                    <span class="assistant-name">Mr. Taylor</span>
                                </div>
                            </li>
                            <li class="subject-item">
                                <div class="subject-left">
                                    <div class="subject-name">English</div>
                                    <div class="subject-meta">
                                        <div class="time-slot">Wed 11:00-12:00</div>
                                    </div>
                                </div>
                                <div class="teacher-info">
                                    <span class="teacher-name">Mr. Brown</span>
                                    <span class="assistant-name unassigned" title="No assistant assigned">No Assistant</span>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="class-card">
                        <div class="card-header">
                            <h3 class="card-title">Class 10B</h3>
                            <button class="edit-btn" onclick="openModal('edit-class')">✏️</button>
                        </div>
                        <ul class="subject-list">
                            <li class="subject-item">
                                <div class="subject-left">
                                    <div class="subject-name">Mathematics</div>
                                    <div class="subject-meta">
                                        <div class="time-slot">Mon 10:00-11:00</div>
                                    </div>
                                </div>
                                <div class="teacher-info">
                                    <span class="teacher-name">Dr. Smith</span>
                                    <span class="assistant-name">Ms. Davis</span>
                                </div>
                            </li>
                            <li class="subject-item overloaded" title="Dr. Wilson is overloaded with +2 extra classes">
                                <div class="subject-left">
                                    <div class="subject-name">Chemistry <span class="extra-periods">+2</span></div>
                                    <div class="subject-meta">
                                        <div class="time-slot">Thu 9:00-10:00</div>
                                    </div>
                                </div>
                                <div class="teacher-info">
                                    <span class="teacher-name overloaded">Dr. Wilson</span>
                                    <span class="assistant-name unassigned" title="No assistant assigned">No Assistant</span>
                                </div>
                            </li>
                            <li class="subject-item">
                                <div class="subject-left">
                                    <div class="subject-name">English</div>
                                    <div class="subject-meta">
                                        <div class="time-slot">Fri 11:00-12:00</div>
                                    </div>
                                </div>
                                <div class="teacher-info">
                                    <span class="teacher-name">Mr. Brown</span>
                                    <span class="assistant-name">Ms. Lee</span>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="class-card underloaded" title="Class 9A needs 1 more subject assignment">
                        <div class="card-header">
                            <h3 class="card-title">Class 9A <span class="missing-periods">-1</span></h3>
                            <button class="edit-btn" onclick="openModal('edit-class')">✏️</button>
                        </div>
                        <ul class="subject-list">
                            <li class="subject-item">
                                <div class="subject-left">
                                    <div class="subject-name">Mathematics</div>
                                    <div class="subject-meta">
                                        <div class="time-slot">Tue 9:00-10:00</div>
                                    </div>
                                </div>
                                <div class="teacher-info">
                                    <span class="teacher-name">Dr. Smith</span>
                                    <span class="assistant-name">Ms. Davis</span>
                                </div>
                            </li>
                            <li class="subject-item">
                                <div class="subject-left">
                                    <div class="subject-name">Physics</div>
                                    <div class="subject-meta">
                                        <div class="time-slot">Wed 10:00-11:00</div>
                                    </div>
                                </div>
                                <div class="teacher-info">
                                    <span class="teacher-name">Ms. Johnson</span>
                                    <span class="assistant-name">Mr. Taylor</span>
                                </div>
                            </li>
                            <li class="subject-item unassigned assignment-row" style="cursor: pointer;" title="Click to assign a subject">
                                <div class="assignment-interface" style="width: 100%; display: flex; flex-direction: column; gap: 12px;">
                                    <div style="font-weight: 600; color: #B8860B; text-align: center;">+ Add Subject</div>
                                    <div style="display: flex; gap: 8px; align-items: center;">
                                        <select class="form-select" style="flex: 1; padding: 8px; font-size: 12px;" onchange="updateTeacherOptions(this)">
                                            <option value="">Select Subject...</option>
                                            <option value="Chemistry">Chemistry (Available)</option>
                                            <option value="Biology">Biology (Available)</option>
                                            <option value="History">History (Available)</option>
                                        </select>
                                        <select class="form-select" style="flex: 1; padding: 8px; font-size: 12px;" disabled id="teacher-select-9a">
                                            <option value="">Select Teacher...</option>
                                        </select>
                                        <select class="form-select" style="flex: 0.8; padding: 8px; font-size: 12px;" disabled id="assistant-select-9a">
                                            <option value="">Assistant...</option>
                                        </select>
                                        <button class="quick-assign-btn" onclick="assignInline('Class 9A')" style="padding: 8px 12px; font-size: 12px;">Assign</button>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Option 3: Schedule/Timeline View -->
            <div id="schedule-option" class="option-content">
                <div class="schedule-container">
                    <div class="schedule-header">
                        <h3>Class 10A - Weekly Schedule</h3>
                        <button class="btn-primary" onclick="openModal('add-schedule')">Add Period</button>
                    </div>
                    <div class="schedule-grid">
                        <div class="time-header">Time</div>
                        <div class="day-header">Mon</div>
                        <div class="day-header">Tue</div>
                        <div class="day-header">Wed</div>
                        <div class="day-header">Thu</div>
                        <div class="day-header">Fri</div>
                        <div class="day-header">Sat</div>
                        <div class="day-header">Sun</div>

                        <div class="time-header">9:00</div>
                        <div class="schedule-cell occupied" onclick="editScheduleCell(this)" title="Mathematics - Dr. Smith + Ms. Davis (Assistant)">
                            <div class="cell-subject">Math</div>
                            <div class="cell-teacher">Dr. Smith</div>
                        </div>
                        <div class="schedule-cell available" onclick="assignToEmptyCell(this, 'Tue', '9:00')" title="Click to assign subject and teacher"></div>
                        <div class="schedule-cell occupied" title="English - Mr. Brown (No Assistant)">
                            <div class="cell-subject">English</div>
                            <div class="cell-teacher">Mr. Brown</div>
                        </div>
                        <div class="schedule-cell available" onclick="assignToEmptyCell(this, 'Thu', '9:00')" title="Click to assign subject and teacher"></div>
                        <div class="schedule-cell occupied warning" title="Physics - Ms. Johnson + Mr. Taylor (Ms. Johnson underloaded - can take 1 more class)">
                            <div class="cell-subject">Physics</div>
                            <div class="cell-teacher">Ms. Johnson</div>
                        </div>
                        <div class="schedule-cell available" onclick="assignToEmptyCell(this, 'Sat', '9:00')" title="Click to assign subject and teacher"></div>
                        <div class="schedule-cell available" onclick="assignToEmptyCell(this, 'Sun', '9:00')" title="Click to assign subject and teacher"></div>

                        <div class="time-header">10:00</div>
                        <div class="schedule-cell available" onclick="assignToEmptyCell(this, 'Mon', '10:00')" title="Click to assign subject and teacher"></div>
                        <div class="schedule-cell occupied" title="Physics - Ms. Johnson + Mr. Taylor (Assistant)">
                            <div class="cell-subject">Physics</div>
                            <div class="cell-teacher">Ms. Johnson</div>
                        </div>
                        <div class="schedule-cell available" onclick="assignToEmptyCell(this, 'Wed', '10:00')" title="Click to assign subject and teacher"></div>
                        <div class="schedule-cell occupied error" title="Chemistry - Dr. Wilson (OVERLOADED: +2 extra classes, needs assistant)">
                            <div class="cell-subject">Chemistry</div>
                            <div class="cell-teacher">Dr. Wilson</div>
                        </div>
                        <div class="schedule-cell available" onclick="assignToEmptyCell(this, 'Fri', '10:00')" title="Click to assign subject and teacher"></div>
                        <div class="schedule-cell available" onclick="assignToEmptyCell(this, 'Sat', '10:00')" title="Click to assign subject and teacher"></div>
                        <div class="schedule-cell available" onclick="assignToEmptyCell(this, 'Sun', '10:00')" title="Click to assign subject and teacher"></div>

                        <div class="time-header">11:00</div>
                        <div class="schedule-cell occupied" title="English - Mr. Brown + Ms. Lee (Assistant)">
                            <div class="cell-subject">English</div>
                            <div class="cell-teacher">Mr. Brown</div>
                        </div>
                        <div class="schedule-cell available" onclick="assignToEmptyCell(this, 'Tue', '11:00')" title="Click to assign subject and teacher"></div>
                        <div class="schedule-cell occupied" title="Mathematics - Dr. Smith + Ms. Davis (Assistant)">
                            <div class="cell-subject">Math</div>
                            <div class="cell-teacher">Dr. Smith</div>
                        </div>
                        <div class="schedule-cell available" onclick="assignToEmptyCell(this, 'Thu', '11:00')" title="Click to assign subject and teacher"></div>
                        <div class="schedule-cell available" onclick="assignToEmptyCell(this, 'Fri', '11:00')" title="Click to assign subject and teacher"></div>
                        <div class="schedule-cell available" onclick="assignToEmptyCell(this, 'Sat', '11:00')" title="Click to assign subject and teacher"></div>
                        <div class="schedule-cell available" onclick="assignToEmptyCell(this, 'Sun', '11:00')" title="Click to assign subject and teacher"></div>
                    </div>
                </div>
            </div>

            <!-- Option 4: Graph Analytics View -->
            <div id="graph-option" class="option-content">
                <div class="graph-analytics-container">
                    <div class="graph-header">
                        <h3>Class Management - Graph Analytics</h3>
                        <div class="graph-controls">
                            <select class="form-select" onchange="switchGraphType(this.value)" style="margin-right: 16px;">
                                <option value="workload">Workload Distribution</option>
                                <option value="coverage">Subject Coverage</option>
                                <option value="efficiency">Schedule Efficiency</option>
                                <option value="network">Relationship Network</option>
                            </select>
                            <button class="btn-secondary" onclick="exportGraph()">Export</button>
                        </div>
                    </div>

                    <!-- Workload Distribution Graph -->
                    <div id="workload-graph" class="graph-view active">
                        <div class="graph-content">
                            <div class="graph-visualization">
                                <svg width="100%" height="400" viewBox="0 0 800 400" style="background: #FAFAFA; border-radius: 12px;">
                                    <!-- Grid lines -->
                                    <defs>
                                        <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
                                            <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#E0E0E0" stroke-width="1"/>
                                        </pattern>
                                    </defs>
                                    <rect width="100%" height="100%" fill="url(#grid)" />
                                    
                                    <!-- Y-axis labels -->
                                    <text x="30" y="50" text-anchor="middle" font-size="12" fill="#606060">25h</text>
                                    <text x="30" y="130" text-anchor="middle" font-size="12" fill="#606060">20h</text>
                                    <text x="30" y="210" text-anchor="middle" font-size="12" fill="#606060">15h</text>
                                    <text x="30" y="290" text-anchor="middle" font-size="12" fill="#606060">10h</text>
                                    <text x="30" y="370" text-anchor="middle" font-size="12" fill="#606060">5h</text>
                                    
                                    <!-- Optimal range indicator -->
                                    <rect x="50" y="170" width="700" height="80" fill="#E8F5E8" opacity="0.3" rx="4"/>
                                    <text x="60" y="185" font-size="10" fill="#28A745">Optimal Range (12-18h)</text>
                                    
                                    <!-- Teacher bars -->
                                    <!-- Dr. Smith - Optimal -->
                                    <rect x="100" y="210" width="80" height="160" fill="#28A745" rx="4"/>
                                    <text x="140" y="390" text-anchor="middle" font-size="12" fill="#1E1E1E">Dr. Smith</text>
                                    <text x="140" y="200" text-anchor="middle" font-size="12" fill="#FFFFFF" font-weight="600">15h</text>
                                    
                                    <!-- Ms. Johnson - Underloaded -->
                                    <rect x="220" y="290" width="80" height="80" fill="#FFC107" rx="4"/>
                                    <text x="260" y="390" text-anchor="middle" font-size="12" fill="#1E1E1E">Ms. Johnson</text>
                                    <text x="260" y="280" text-anchor="middle" font-size="12" fill="#1E1E1E" font-weight="600">10h</text>
                                    
                                    <!-- Mr. Brown - Underloaded -->
                                    <rect x="340" y="290" width="80" height="80" fill="#FFC107" rx="4"/>
                                    <text x="380" y="390" text-anchor="middle" font-size="12" fill="#1E1E1E">Mr. Brown</text>
                                    <text x="380" y="280" text-anchor="middle" font-size="12" fill="#1E1E1E" font-weight="600">10h</text>
                                    
                                    <!-- Dr. Wilson - Overloaded -->
                                    <rect x="460" y="50" width="80" height="320" fill="#DC3545" rx="4"/>
                                    <text x="500" y="390" text-anchor="middle" font-size="12" fill="#1E1E1E">Dr. Wilson</text>
                                    <text x="500" y="40" text-anchor="middle" font-size="12" fill="#DC3545" font-weight="600">25h</text>
                                    <text x="500" y="25" text-anchor="middle" font-size="10" fill="#DC3545">OVERLOADED</text>
                                    
                                    <!-- Assistant Teachers -->
                                    <rect x="580" y="330" width="60" height="40" fill="#7B54FA" rx="4"/>
                                    <text x="610" y="390" text-anchor="middle" font-size="10" fill="#1E1E1E">Ms. Davis</text>
                                    <text x="610" y="320" text-anchor="middle" font-size="10" fill="#FFFFFF">8h</text>
                                    
                                    <rect x="660" y="350" width="60" height="20" fill="#7B54FA" rx="4"/>
                                    <text x="690" y="390" text-anchor="middle" font-size="10" fill="#1E1E1E">Mr. Taylor</text>
                                    <text x="690" y="340" text-anchor="middle" font-size="10" fill="#FFFFFF">4h</text>
                                </svg>
                            </div>
                            
                            <div class="graph-insights">
                                <h4>Key Insights</h4>
                                <div class="insight-item critical">
                                    <span class="insight-icon">⚠</span>
                                    <div class="insight-text">
                                        <strong>Critical Issue:</strong> Dr. Wilson is 67% overloaded (25h vs 15h target)
                                    </div>
                                </div>
                                <div class="insight-item warning">
                                    <span class="insight-icon">!</span>
                                    <div class="insight-text">
                                        <strong>Underutilization:</strong> Ms. Johnson & Mr. Brown have 33% capacity available
                                    </div>
                                </div>
                                <div class="insight-item success">
                                    <span class="insight-icon">✓</span>
                                    <div class="insight-text">
                                        <strong>Optimal:</strong> Dr. Smith is perfectly balanced at 15h/week
                                    </div>
                                </div>
                                <div class="insight-item info">
                                    <span class="insight-icon">💡</span>
                                    <div class="insight-text">
                                        <strong>Recommendation:</strong> Redistribute 2 classes from Dr. Wilson to underloaded teachers
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Subject Coverage Graph -->
                    <div id="coverage-graph" class="graph-view">
                        <div class="graph-content">
                            <div class="coverage-donut-chart">
                                <svg width="400" height="400" viewBox="0 0 400 400">
                                    <!-- Mathematics - 100% -->
                                    <circle cx="200" cy="200" r="120" fill="none" stroke="#E0E0E0" stroke-width="20"/>
                                    <circle cx="200" cy="200" r="120" fill="none" stroke="#28A745" stroke-width="20" 
                                            stroke-dasharray="754" stroke-dashoffset="0" transform="rotate(-90 200 200)"/>
                                    
                                    <!-- Physics - 67% -->
                                    <circle cx="200" cy="200" r="90" fill="none" stroke="#E0E0E0" stroke-width="20"/>
                                    <circle cx="200" cy="200" r="90" fill="none" stroke="#FFC107" stroke-width="20" 
                                            stroke-dasharray="565" stroke-dashoffset="187" transform="rotate(-90 200 200)"/>
                                    
                                    <!-- English - 67% -->
                                    <circle cx="200" cy="200" r="60" fill="none" stroke="#E0E0E0" stroke-width="20"/>
                                    <circle cx="200" cy="200" r="60" fill="none" stroke="#FFC107" stroke-width="20" 
                                            stroke-dasharray="377" stroke-dashoffset="124" transform="rotate(-90 200 200)"/>
                                    
                                    <!-- Chemistry - 33% -->
                                    <circle cx="200" cy="200" r="30" fill="none" stroke="#E0E0E0" stroke-width="20"/>
                                    <circle cx="200" cy="200" r="30" fill="none" stroke="#DC3545" stroke-width="20" 
                                            stroke-dasharray="188" stroke-dashoffset="126" transform="rotate(-90 200 200)"/>
                                    
                                    <!-- Center text -->
                                    <text x="200" y="195" text-anchor="middle" font-size="24" font-weight="600" fill="#1E1E1E">67%</text>
                                    <text x="200" y="215" text-anchor="middle" font-size="14" fill="#606060">Overall Coverage</text>
                                </svg>
                            </div>
                            
                            <div class="coverage-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #28A745;"></div>
                                    <span>Mathematics (100%)</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #FFC107;"></div>
                                    <span>Physics (67%)</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #FFC107;"></div>
                                    <span>English (67%)</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #DC3545;"></div>
                                    <span>Chemistry (33%)</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Schedule Efficiency Graph -->
                    <div id="efficiency-graph" class="graph-view">
                        <div class="efficiency-metrics-visual">
                            <div class="efficiency-gauge">
                                <svg width="300" height="200" viewBox="0 0 300 200">
                                    <!-- Gauge background -->
                                    <path d="M 50 150 A 100 100 0 0 1 250 150" fill="none" stroke="#E0E0E0" stroke-width="20"/>
                                    <!-- Gauge fill (72%) -->
                                    <path d="M 50 150 A 100 100 0 0 1 222 89" fill="none" stroke="#7B54FA" stroke-width="20"/>
                                    <!-- Gauge pointer -->
                                    <line x1="150" y1="150" x2="222" y2="89" stroke="#1E1E1E" stroke-width="3"/>
                                    <circle cx="150" cy="150" r="8" fill="#1E1E1E"/>
                                    
                                    <!-- Labels -->
                                    <text x="50" y="170" text-anchor="middle" font-size="12" fill="#606060">0%</text>
                                    <text x="150" y="180" text-anchor="middle" font-size="12" fill="#606060">50%</text>
                                    <text x="250" y="170" text-anchor="middle" font-size="12" fill="#606060">100%</text>
                                    
                                    <!-- Center value -->
                                    <text x="150" y="130" text-anchor="middle" font-size="32" font-weight="600" fill="#7B54FA">72%</text>
                                    <text x="150" y="145" text-anchor="middle" font-size="14" fill="#606060">Efficiency</text>
                                </svg>
                            </div>
                            
                            <div class="efficiency-breakdown">
                                <div class="breakdown-item">
                                    <span class="breakdown-label">Time Utilization:</span>
                                    <div class="breakdown-bar">
                                        <div class="breakdown-fill" style="width: 85%; background: #28A745;"></div>
                                    </div>
                                    <span class="breakdown-value">85%</span>
                                </div>
                                <div class="breakdown-item">
                                    <span class="breakdown-label">Teacher Balance:</span>
                                    <div class="breakdown-bar">
                                        <div class="breakdown-fill" style="width: 45%; background: #DC3545;"></div>
                                    </div>
                                    <span class="breakdown-value">45%</span>
                                </div>
                                <div class="breakdown-item">
                                    <span class="breakdown-label">Subject Coverage:</span>
                                    <div class="breakdown-bar">
                                        <div class="breakdown-fill" style="width: 67%; background: #FFC107;"></div>
                                    </div>
                                    <span class="breakdown-value">67%</span>
                                </div>
                                <div class="breakdown-item">
                                    <span class="breakdown-label">Schedule Conflicts:</span>
                                    <div class="breakdown-bar">
                                        <div class="breakdown-fill" style="width: 15%; background: #DC3545;"></div>
                                    </div>
                                    <span class="breakdown-value">15%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Relationship Network Graph -->
                    <div id="network-graph" class="graph-view">
                        <div class="network-visualization">
                            <svg width="100%" height="500" viewBox="0 0 800 500" style="background: #FAFAFA; border-radius: 12px;">
                                <!-- Connection lines -->
                                <line x1="150" y1="100" x2="400" y2="150" stroke="#7B54FA" stroke-width="2" opacity="0.6"/>
                                <line x1="150" y1="200" x2="400" y2="150" stroke="#7B54FA" stroke-width="2" opacity="0.6"/>
                                <line x1="150" y1="300" x2="400" y2="250" stroke="#FFC107" stroke-width="2" opacity="0.6"/>
                                <line x1="150" y1="400" x2="400" y2="350" stroke="#DC3545" stroke-width="3" opacity="0.8"/>
                                
                                <line x1="400" y1="150" x2="650" y2="100" stroke="#28A745" stroke-width="3" opacity="0.8"/>
                                <line x1="400" y1="250" x2="650" y2="200" stroke="#FFC107" stroke-width="2" opacity="0.6"/>
                                <line x1="400" y1="350" x2="650" y2="300" stroke="#DC3545" stroke-width="3" opacity="0.8"/>
                                
                                <!-- Classes (Left) -->
                                <circle cx="150" cy="100" r="25" fill="#E8F4FD" stroke="#7B54FA" stroke-width="2"/>
                                <text x="150" y="105" text-anchor="middle" font-size="10" font-weight="600" fill="#1E1E1E">10A</text>
                                
                                <circle cx="150" cy="200" r="25" fill="#E8F4FD" stroke="#7B54FA" stroke-width="2"/>
                                <text x="150" y="205" text-anchor="middle" font-size="10" font-weight="600" fill="#1E1E1E">10B</text>
                                
                                <circle cx="150" cy="300" r="25" fill="#FFF9E6" stroke="#FFC107" stroke-width="2"/>
                                <text x="150" y="305" text-anchor="middle" font-size="10" font-weight="600" fill="#1E1E1E">9A</text>
                                
                                <!-- Subjects (Center) -->
                                <circle cx="400" cy="150" r="30" fill="#E8F5E8" stroke="#28A745" stroke-width="3"/>
                                <text x="400" y="155" text-anchor="middle" font-size="10" font-weight="600" fill="#1E1E1E">Math</text>
                                
                                <circle cx="400" cy="250" r="30" fill="#FFF9E6" stroke="#FFC107" stroke-width="2"/>
                                <text x="400" y="255" text-anchor="middle" font-size="10" font-weight="600" fill="#1E1E1E">Physics</text>
                                
                                <circle cx="400" cy="350" r="30" fill="#FFE6E6" stroke="#DC3545" stroke-width="3"/>
                                <text x="400" y="355" text-anchor="middle" font-size="10" font-weight="600" fill="#1E1E1E">Chem</text>
                                
                                <!-- Teachers (Right) -->
                                <circle cx="650" cy="100" r="35" fill="#E8F5E8" stroke="#28A745" stroke-width="3"/>
                                <text x="650" y="105" text-anchor="middle" font-size="9" font-weight="600" fill="#1E1E1E">Dr. Smith</text>
                                
                                <circle cx="650" cy="200" r="35" fill="#FFF9E6" stroke="#FFC107" stroke-width="2"/>
                                <text x="650" y="205" text-anchor="middle" font-size="9" font-weight="600" fill="#1E1E1E">Ms. Johnson</text>
                                
                                <circle cx="650" cy="300" r="35" fill="#FFE6E6" stroke="#DC3545" stroke-width="3"/>
                                <text x="650" y="305" text-anchor="middle" font-size="9" font-weight="600" fill="#1E1E1E">Dr. Wilson</text>
                                
                                <!-- Labels -->
                                <text x="150" y="50" text-anchor="middle" font-size="16" font-weight="600" fill="#7B54FA">Classes</text>
                                <text x="400" y="50" text-anchor="middle" font-size="16" font-weight="600" fill="#7B54FA">Subjects</text>
                                <text x="650" y="50" text-anchor="middle" font-size="16" font-weight="600" fill="#7B54FA">Teachers</text>
                                
                                <!-- Legend -->
                                <rect x="50" y="450" width="15" height="3" fill="#28A745"/>
                                <text x="75" y="460" font-size="12" fill="#606060">Optimal</text>
                                
                                <rect x="150" y="450" width="15" height="3" fill="#FFC107"/>
                                <text x="175" y="460" font-size="12" fill="#606060">Warning</text>
                                
                                <rect x="250" y="450" width="15" height="3" fill="#DC3545"/>
                                <text x="275" y="460" font-size="12" fill="#606060">Critical</text>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Teacher View Section -->
        <div id="teacher-view" class="content-section">
            <h2 class="section-title">Teacher Management</h2>
            
            <div class="options-nav">
                <div class="option-tab active" onclick="switchTeacherOption('cards')">Teacher Cards</div>
                <div class="option-tab" onclick="switchTeacherOption('schedule')">Schedule View</div>
                <div class="option-tab" onclick="switchTeacherOption('workload')">Workload Analysis</div>
            </div>

            <!-- Teacher Cards View -->
            <div id="teacher-cards-option" class="option-content active">
                <div class="grid-container">
                    <div class="teacher-card">
                        <div class="card-header">
                            <h3 class="card-title">Dr. Smith</h3>
                            <button class="edit-btn" onclick="openModal('edit-teacher')">✏️</button>
                        </div>
                        <ul class="subject-list">
                            <li class="subject-item">
                                <span class="subject-name">Mathematics - Class 10A</span>
                                <div class="time-slot">Mon 9:00-10:00</div>
                            </li>
                            <li class="subject-item">
                                <span class="subject-name">Mathematics - Class 10B</span>
                                <div class="time-slot">Mon 10:00-11:00</div>
                            </li>
                            <li class="subject-item">
                                <span class="subject-name">Mathematics - Class 9A</span>
                                <div class="time-slot">Tue 9:00-10:00</div>
                            </li>
                        </ul>
                    </div>

                    <div class="teacher-card">
                        <div class="card-header">
                            <h3 class="card-title">Ms. Johnson</h3>
                            <button class="edit-btn" onclick="openModal('edit-teacher')">✏️</button>
                        </div>
                        <ul class="subject-list">
                            <li class="subject-item">
                                <span class="subject-name">Physics - Class 10A</span>
                                <div class="time-slot">Tue 10:00-11:00</div>
                            </li>
                            <li class="subject-item">
                                <span class="subject-name">Physics - Class 9A</span>
                                <div class="time-slot">Wed 10:00-11:00</div>
                            </li>
                        </ul>
                    </div>

                    <div class="teacher-card">
                        <div class="card-header">
                            <h3 class="card-title">Mr. Brown</h3>
                            <button class="edit-btn" onclick="openModal('edit-teacher')">✏️</button>
                        </div>
                        <ul class="subject-list">
                            <li class="subject-item">
                                <span class="subject-name">English - Class 10A</span>
                                <div class="time-slot">Wed 11:00-12:00</div>
                            </li>
                            <li class="subject-item">
                                <span class="subject-name">English - Class 10B</span>
                                <div class="time-slot">Fri 11:00-12:00</div>
                            </li>
                        </ul>
                    </div>

                    <div class="teacher-card overloaded">
                        <div class="card-header">
                            <h3 class="card-title">Dr. Wilson <span class="extra-periods">+2</span></h3>
                            <button class="edit-btn" onclick="openModal('edit-teacher')">✏️</button>
                        </div>
                        <ul class="subject-list">
                            <li class="subject-item overloaded">
                                <span class="subject-name">Chemistry - Class 10B</span>
                                <div class="time-slot">Thu 9:00-10:00</div>
                            </li>
                            <li class="subject-item overloaded">
                                <span class="subject-name">Biology - Class 11A</span>
                                <div class="time-slot">Fri 10:00-11:00</div>
                            </li>
                            <li class="subject-item overloaded">
                                <span class="subject-name">Chemistry - Class 11B</span>
                                <div class="time-slot">Mon 11:00-12:00</div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Teacher Schedule View -->
            <div id="teacher-schedule-option" class="option-content">
                <div class="teacher-schedule-container">
                    <div class="teacher-schedule-header">
                        <h3>All Teachers - Weekly Schedule Overview</h3>
                        <div class="schedule-controls">
                            <button class="btn-secondary" onclick="exportTeacherSchedule()">Export</button>
                            <button class="btn-primary" onclick="optimizeAllSchedules()">Optimize All</button>
                        </div>
                    </div>
                    
                    <div class="teacher-schedule-grid">
                        <div class="teacher-name-header">Teacher</div>
                        <div class="day-header">Mon</div>
                        <div class="day-header">Tue</div>
                        <div class="day-header">Wed</div>
                        <div class="day-header">Thu</div>
                        <div class="day-header">Fri</div>
                        <div class="workload-header">Load</div>

                        <!-- Dr. Smith Row -->
                        <div class="teacher-name-cell">
                            <div class="teacher-name-title">Dr. Smith</div>
                            <div class="teacher-subject">Mathematics</div>
                        </div>
                        <div class="teacher-schedule-cell occupied">
                            <div class="schedule-period">9:00 - 10A Math</div>
                            <div class="schedule-period">10:00 - 10B Math</div>
                        </div>
                        <div class="teacher-schedule-cell occupied">
                            <div class="schedule-period">9:00 - 9A Math</div>
                        </div>
                        <div class="teacher-schedule-cell available"></div>
                        <div class="teacher-schedule-cell available"></div>
                        <div class="teacher-schedule-cell available"></div>
                        <div class="workload-cell optimal">
                            <div class="workload-hours">15h</div>
                            <div class="workload-status">Optimal</div>
                        </div>

                        <!-- Ms. Johnson Row -->
                        <div class="teacher-name-cell">
                            <div class="teacher-name-title">Ms. Johnson</div>
                            <div class="teacher-subject">Physics</div>
                        </div>
                        <div class="teacher-schedule-cell available"></div>
                        <div class="teacher-schedule-cell occupied">
                            <div class="schedule-period">10:00 - 10A Physics</div>
                        </div>
                        <div class="teacher-schedule-cell occupied">
                            <div class="schedule-period">10:00 - 9A Physics</div>
                        </div>
                        <div class="teacher-schedule-cell available"></div>
                        <div class="teacher-schedule-cell occupied">
                            <div class="schedule-period">9:00 - 10A Physics</div>
                        </div>
                        <div class="workload-cell underloaded">
                            <div class="workload-hours">10h</div>
                            <div class="workload-status">Under</div>
                        </div>

                        <!-- Mr. Brown Row -->
                        <div class="teacher-name-cell">
                            <div class="teacher-name-title">Mr. Brown</div>
                            <div class="teacher-subject">English</div>
                        </div>
                        <div class="teacher-schedule-cell available"></div>
                        <div class="teacher-schedule-cell available"></div>
                        <div class="teacher-schedule-cell occupied">
                            <div class="schedule-period">11:00 - 10A English</div>
                        </div>
                        <div class="teacher-schedule-cell available"></div>
                        <div class="teacher-schedule-cell occupied">
                            <div class="schedule-period">11:00 - 10B English</div>
                        </div>
                        <div class="workload-cell underloaded">
                            <div class="workload-hours">10h</div>
                            <div class="workload-status">Under</div>
                        </div>

                        <!-- Dr. Wilson Row -->
                        <div class="teacher-name-cell overloaded">
                            <div class="teacher-name-title">Dr. Wilson</div>
                            <div class="teacher-subject">Chemistry, Biology</div>
                        </div>
                        <div class="teacher-schedule-cell occupied conflict">
                            <div class="schedule-period">11:00 - 11B Chem</div>
                            <div class="schedule-period">12:00 - 11A Bio</div>
                        </div>
                        <div class="teacher-schedule-cell occupied">
                            <div class="schedule-period">11:00 - 11C Bio</div>
                        </div>
                        <div class="teacher-schedule-cell occupied">
                            <div class="schedule-period">12:00 - 11D Chem</div>
                        </div>
                        <div class="teacher-schedule-cell occupied conflict">
                            <div class="schedule-period">9:00 - 10B Chem</div>
                            <div class="schedule-period">10:00 - 11E Bio</div>
                        </div>
                        <div class="teacher-schedule-cell occupied">
                            <div class="schedule-period">10:00 - 11A Bio</div>
                        </div>
                        <div class="workload-cell overloaded">
                            <div class="workload-hours">25h</div>
                            <div class="workload-status">Over +2</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Workload Analysis View -->
            <div id="teacher-workload-option" class="option-content">
                <div class="workload-analysis-container">
                    <div class="workload-summary">
                        <div class="workload-card optimal">
                            <div class="workload-number">1</div>
                            <div class="workload-label">Optimal Load</div>
                            <div class="workload-teachers">Dr. Smith</div>
                        </div>
                        <div class="workload-card underloaded">
                            <div class="workload-number">2</div>
                            <div class="workload-label">Underloaded</div>
                            <div class="workload-teachers">Ms. Johnson, Mr. Brown</div>
                        </div>
                        <div class="workload-card overloaded">
                            <div class="workload-number">1</div>
                            <div class="workload-label">Overloaded</div>
                            <div class="workload-teachers">Dr. Wilson</div>
                        </div>
                    </div>

                    <div class="workload-charts">
                        <div class="workload-chart">
                            <h4>Weekly Hours Distribution</h4>
                            <div class="chart-bars">
                                <div class="chart-bar">
                                    <div class="bar-fill optimal" style="height: 75%;"></div>
                                    <div class="bar-label">Dr. Smith<br>15h</div>
                                </div>
                                <div class="chart-bar">
                                    <div class="bar-fill underloaded" style="height: 50%;"></div>
                                    <div class="bar-label">Ms. Johnson<br>10h</div>
                                </div>
                                <div class="chart-bar">
                                    <div class="bar-fill underloaded" style="height: 50%;"></div>
                                    <div class="bar-label">Mr. Brown<br>10h</div>
                                </div>
                                <div class="chart-bar">
                                    <div class="bar-fill overloaded" style="height: 100%;"></div>
                                    <div class="bar-label">Dr. Wilson<br>25h</div>
                                </div>
                            </div>
                        </div>

                        <div class="efficiency-metrics">
                            <h4>Efficiency Metrics</h4>
                            <div class="metric-item">
                                <span class="metric-label">Average Workload:</span>
                                <span class="metric-value">15 hours/week</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Workload Variance:</span>
                                <span class="metric-value warning">High (±7.5h)</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Schedule Efficiency:</span>
                                <span class="metric-value">72%</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Optimization Potential:</span>
                                <span class="metric-value success">+28%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Subject View Section -->
        <div id="subject-view" class="content-section">
            <h2 class="section-title">Subject Management</h2>
            
            <div class="options-nav">
                <div class="option-tab active" onclick="switchSubjectOption('overview')">Subject Overview</div>
                <div class="option-tab" onclick="switchSubjectOption('coverage')">Class Coverage</div>
                <div class="option-tab" onclick="switchSubjectOption('analytics')">Analytics</div>
            </div>

            <!-- Subject Overview -->
            <div id="subject-overview-option" class="option-content active">
                <div class="grid-container">
                    <div class="subject-card optimal">
                        <div class="card-header">
                            <h3 class="card-title">Mathematics</h3>
                            <span class="subject-status-badge optimal">Fully Assigned</span>
                        </div>
                        <div class="subject-stats">
                            <div class="stat-item">
                                <span class="stat-number">3</span>
                                <span class="stat-label">Classes</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">90</span>
                                <span class="stat-label">Students</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">15</span>
                                <span class="stat-label">Hours/Week</span>
                            </div>
                        </div>
                        <div class="subject-teacher-info">
                            <div class="primary-teacher">
                                <span class="teacher-badge pt">PT</span>
                                <span>Dr. Smith</span>
                            </div>
                            <div class="assistant-teacher">
                                <span class="teacher-badge at">AT</span>
                                <span>Ms. Davis</span>
                            </div>
                        </div>
                    </div>

                    <div class="subject-card warning">
                        <div class="card-header">
                            <h3 class="card-title">Physics</h3>
                            <span class="subject-status-badge warning">Needs 1 Class</span>
                        </div>
                        <div class="subject-stats">
                            <div class="stat-item">
                                <span class="stat-number">2</span>
                                <span class="stat-label">Classes</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">62</span>
                                <span class="stat-label">Students</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">10</span>
                                <span class="stat-label">Hours/Week</span>
                            </div>
                        </div>
                        <div class="subject-teacher-info">
                            <div class="primary-teacher">
                                <span class="teacher-badge pt">PT</span>
                                <span>Ms. Johnson</span>
                            </div>
                            <div class="assistant-teacher">
                                <span class="teacher-badge at">AT</span>
                                <span>Mr. Taylor</span>
                            </div>
                        </div>
                    </div>

                    <div class="subject-card warning">
                        <div class="card-header">
                            <h3 class="card-title">English</h3>
                            <span class="subject-status-badge warning">Needs 1 Class</span>
                        </div>
                        <div class="subject-stats">
                            <div class="stat-item">
                                <span class="stat-number">2</span>
                                <span class="stat-label">Classes</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">58</span>
                                <span class="stat-label">Students</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">10</span>
                                <span class="stat-label">Hours/Week</span>
                            </div>
                        </div>
                        <div class="subject-teacher-info">
                            <div class="primary-teacher">
                                <span class="teacher-badge pt">PT</span>
                                <span>Mr. Brown</span>
                            </div>
                            <div class="assistant-teacher">
                                <span class="teacher-badge at">AT</span>
                                <span>Ms. Lee</span>
                            </div>
                        </div>
                    </div>

                    <div class="subject-card critical">
                        <div class="card-header">
                            <h3 class="card-title">Chemistry</h3>
                            <span class="subject-status-badge critical">Critical Issue</span>
                        </div>
                        <div class="subject-stats">
                            <div class="stat-item">
                                <span class="stat-number">1</span>
                                <span class="stat-label">Classes</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">28</span>
                                <span class="stat-label">Students</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">5</span>
                                <span class="stat-label">Hours/Week</span>
                            </div>
                        </div>
                        <div class="subject-teacher-info">
                            <div class="primary-teacher overloaded">
                                <span class="teacher-badge pt">PT</span>
                                <span>Dr. Wilson (Overloaded)</span>
                            </div>
                            <div class="assistant-teacher unassigned">
                                <span class="teacher-badge at">AT</span>
                                <span>No Assistant</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Class Coverage View -->
            <div id="subject-coverage-option" class="option-content">
                <div class="coverage-matrix">
                    <h3>Subject-Class Coverage Matrix</h3>
                    <div class="coverage-grid">
                        <div class="coverage-header"></div>
                        <div class="coverage-header">Class 10A</div>
                        <div class="coverage-header">Class 10B</div>
                        <div class="coverage-header">Class 9A</div>
                        <div class="coverage-header">Coverage %</div>

                        <div class="subject-row-header">Mathematics</div>
                        <div class="coverage-cell assigned">✓ Dr. Smith</div>
                        <div class="coverage-cell assigned">✓ Dr. Smith</div>
                        <div class="coverage-cell assigned">✓ Dr. Smith</div>
                        <div class="coverage-percentage optimal">100%</div>

                        <div class="subject-row-header">Physics</div>
                        <div class="coverage-cell assigned">✓ Ms. Johnson</div>
                        <div class="coverage-cell unassigned">⚠ Unassigned</div>
                        <div class="coverage-cell assigned">✓ Ms. Johnson</div>
                        <div class="coverage-percentage warning">67%</div>

                        <div class="subject-row-header">English</div>
                        <div class="coverage-cell assigned">✓ Mr. Brown</div>
                        <div class="coverage-cell assigned">✓ Mr. Brown</div>
                        <div class="coverage-cell unassigned">⚠ Unassigned</div>
                        <div class="coverage-percentage warning">67%</div>

                        <div class="subject-row-header">Chemistry</div>
                        <div class="coverage-cell unassigned">⚠ Unassigned</div>
                        <div class="coverage-cell assigned conflict">⚠ Dr. Wilson</div>
                        <div class="coverage-cell unassigned">⚠ Unassigned</div>
                        <div class="coverage-percentage critical">33%</div>
                    </div>
                </div>
            </div>

            <!-- Subject Analytics -->
            <div id="subject-analytics-option" class="option-content">
                <div class="analytics-dashboard">
                    <div class="analytics-summary">
                        <div class="analytics-card">
                            <div class="analytics-number">67%</div>
                            <div class="analytics-label">Overall Coverage</div>
                            <div class="analytics-trend warning">↓ 8% from target</div>
                        </div>
                        <div class="analytics-card">
                            <div class="analytics-number">2.3</div>
                            <div class="analytics-label">Avg Classes/Subject</div>
                            <div class="analytics-trend">→ Stable</div>
                        </div>
                        <div class="analytics-card">
                            <div class="analytics-number">1</div>
                            <div class="analytics-label">Critical Issues</div>
                            <div class="analytics-trend critical">↑ Needs attention</div>
                        </div>
                    </div>

                    <div class="subject-performance-chart">
                        <h4>Subject Performance Overview</h4>
                        <div class="performance-bars">
                            <div class="performance-item">
                                <div class="performance-label">Mathematics</div>
                                <div class="performance-bar">
                                    <div class="performance-fill optimal" style="width: 100%;"></div>
                                </div>
                                <div class="performance-score">100%</div>
                            </div>
                            <div class="performance-item">
                                <div class="performance-label">Physics</div>
                                <div class="performance-bar">
                                    <div class="performance-fill warning" style="width: 67%;"></div>
                                </div>
                                <div class="performance-score">67%</div>
                            </div>
                            <div class="performance-item">
                                <div class="performance-label">English</div>
                                <div class="performance-bar">
                                    <div class="performance-fill warning" style="width: 67%;"></div>
                                </div>
                                <div class="performance-score">67%</div>
                            </div>
                            <div class="performance-item">
                                <div class="performance-label">Chemistry</div>
                                <div class="performance-bar">
                                    <div class="performance-fill critical" style="width: 33%;"></div>
                                </div>
                                <div class="performance-score">33%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Assignment Modal -->
        <div id="assignment-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="assignment-modal-title">Assign Teacher</h3>
                    <button class="close-btn" onclick="closeAssignmentModal()">&times;</button>
                </div>
                <div id="assignment-content">
                    <!-- Content will be dynamically populated -->
                </div>
            </div>
        </div>

        <!-- Schedule Grid Modal -->
        <div id="schedule-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="schedule-modal-title">Subject Schedule</h3>
                    <button class="close-btn" onclick="closeScheduleModal()">&times;</button>
                </div>
                <div id="schedule-content">
                    <p style="margin-bottom: 16px; color: #606060;">Click on time slots to assign periods for this subject:</p>
                    <div class="schedule-grid-modal">
                        <div class="day-label">Mon</div>
                        <div class="day-label">Tue</div>
                        <div class="day-label">Wed</div>
                        <div class="day-label">Thu</div>
                        <div class="day-label">Fri</div>
                        <div class="day-label">Sat</div>
                        
                        <div class="period-cell available" onclick="togglePeriod(this, 'Mon', '9:00')">9:00</div>
                        <div class="period-cell assigned" onclick="togglePeriod(this, 'Tue', '9:00')">9:00</div>
                        <div class="period-cell available" onclick="togglePeriod(this, 'Wed', '9:00')">9:00</div>
                        <div class="period-cell conflict" onclick="togglePeriod(this, 'Thu', '9:00')">9:00</div>
                        <div class="period-cell available" onclick="togglePeriod(this, 'Fri', '9:00')">9:00</div>
                        <div class="period-cell available" onclick="togglePeriod(this, 'Sat', '9:00')">9:00</div>
                        
                        <div class="period-cell available" onclick="togglePeriod(this, 'Mon', '10:00')">10:00</div>
                        <div class="period-cell available" onclick="togglePeriod(this, 'Tue', '10:00')">10:00</div>
                        <div class="period-cell assigned" onclick="togglePeriod(this, 'Wed', '10:00')">10:00</div>
                        <div class="period-cell available" onclick="togglePeriod(this, 'Thu', '10:00')">10:00</div>
                        <div class="period-cell available" onclick="togglePeriod(this, 'Fri', '10:00')">10:00</div>
                        <div class="period-cell available" onclick="togglePeriod(this, 'Sat', '10:00')">10:00</div>
                        
                        <div class="period-cell available" onclick="togglePeriod(this, 'Mon', '11:00')">11:00</div>
                        <div class="period-cell available" onclick="togglePeriod(this, 'Tue', '11:00')">11:00</div>
                        <div class="period-cell available" onclick="togglePeriod(this, 'Wed', '11:00')">11:00</div>
                        <div class="period-cell assigned" onclick="togglePeriod(this, 'Thu', '11:00')">11:00</div>
                        <div class="period-cell available" onclick="togglePeriod(this, 'Fri', '11:00')">11:00</div>
                        <div class="period-cell available" onclick="togglePeriod(this, 'Sat', '11:00')">11:00</div>
                    </div>
                    <div style="margin-top: 16px; padding: 12px; background: #F7F7F7; border-radius: 8px; font-size: 14px;">
                        <strong>Legend:</strong>
                        <span style="color: #7B54FA;">■ Assigned</span> |
                        <span style="color: #28A745;">■ Available</span> |
                        <span style="color: #DC3545;">■ Conflict</span>
                    </div>
                    <div style="margin-top: 24px;">
                        <button type="button" class="btn-secondary" onclick="closeScheduleModal()">Cancel</button>
                        <button type="button" class="btn-primary" onclick="saveSchedule()">Save Schedule</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit Modal -->
        <div id="edit-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Edit Assignment</h3>
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                </div>
                <form>
                    <div class="form-group">
                        <label class="form-label">Teacher</label>
                        <select class="form-select">
                            <option>Dr. Smith</option>
                            <option>Ms. Johnson</option>
                            <option>Mr. Brown</option>
                            <option>Dr. Wilson</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Subject</label>
                        <select class="form-select">
                            <option>Mathematics</option>
                            <option>Physics</option>
                            <option>English</option>
                            <option>Chemistry</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Class</label>
                        <select class="form-select">
                            <option>Class 10A</option>
                            <option>Class 10B</option>
                            <option>Class 9A</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Time Slot</label>
                        <input type="text" class="form-input" placeholder="e.g., Mon 9:00-10:00">
                    </div>
                    <div style="margin-top: 24px;">
                        <button type="button" class="btn-secondary" onclick="closeModal()">Cancel</button>
                        <button type="submit" class="btn-primary">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        let selectedNodes = [];

        function switchView(view) {
            // Update toggle buttons
            document.querySelectorAll('.toggle-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Show/hide content sections
            document.querySelectorAll('.content-section').forEach(section => section.classList.remove('active'));
            document.getElementById(view + '-view').classList.add('active');
        }

        function switchOption(option) {
            // Update option tabs
            document.querySelectorAll('.option-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            // Show/hide option content
            document.querySelectorAll('.option-content').forEach(content => content.classList.remove('active'));
            document.getElementById(option + '-option').classList.add('active');
        }

        function selectNode(element, type, name) {
            // Clear previous selections
            document.querySelectorAll('.node').forEach(node => node.classList.remove('selected'));
            
            // Select current node
            element.classList.add('selected');
            
            // If subject is selected, reorganize the entire network view
            if (type === 'subject') {
                reorganizeNetworkForSubject(name);
            } else {
                // Show connections based on selection
                showConnections(type, name);
            }
            
            // Show assignment options based on node type
            if (type === 'teacher' || type === 'subject') {
                showAssignmentOptions(type, name, element);
            }
        }

        function showAssignmentOptions(type, name, element) {
            // Add a small delay to show the assignment modal
            setTimeout(() => {
                if (type === 'teacher') {
                    openTeacherAssignmentModal(name);
                } else if (type === 'subject') {
                    openSubjectAssignmentModal(name);
                }
            }, 300);
        }

        function openTeacherAssignmentModal(teacherName) {
            // Find the teacher node and add inline assignment interface
            const teacherNode = document.querySelector(`[data-teacher="${teacherName}"]`);
            if (!teacherNode) return;
            
            // Remove any existing inline interfaces
            document.querySelectorAll('.inline-assignment').forEach(el => el.remove());
            
            // Get teacher's current subjects
            const teacherSubjects = {
                'Dr. Smith': ['Mathematics'],
                'Ms. Johnson': ['Physics'],
                'Mr. Brown': ['English'],
                'Dr. Wilson': ['Chemistry', 'Biology']
            };
            
            const subjects = teacherSubjects[teacherName] || [];
            
            // Create inline assignment interface
            const inlineInterface = document.createElement('div');
            inlineInterface.className = 'inline-assignment';
            inlineInterface.innerHTML = `
                <div class="inline-assignment-content">
                    <div class="inline-header">
                        <h4>${teacherName} - Quick Actions</h4>
                        <button class="close-inline-btn" onclick="closeInlineAssignment()">&times;</button>
                    </div>
                    <div class="inline-subjects">
                        <label class="inline-label">Current Subjects:</label>
                        ${subjects.map(subject => `
                            <div class="inline-subject-item">
                                <span>${subject}</span>
                                <button class="inline-reassign-btn" onclick="showInlineReassign('${teacherName}', '${subject}')">Change</button>
                            </div>
                        `).join('')}
                    </div>
                    <div class="inline-add-subject">
                        <label class="inline-label">Add Subject:</label>
                        <div class="inline-form-row">
                            <select class="inline-select" id="inline-subject-${teacherName.replace(/\s+/g, '')}">
                                <option value="">Select subject...</option>
                                <option value="Mathematics">Mathematics</option>
                                <option value="Physics">Physics</option>
                                <option value="English">English</option>
                                <option value="Chemistry">Chemistry</option>
                                <option value="Biology">Biology</option>
                            </select>
                            <button class="inline-assign-btn" onclick="assignSubjectInline('${teacherName}')">Add</button>
                        </div>
                    </div>
                    <div class="inline-actions">
                        <button class="inline-schedule-btn" onclick="openScheduleModal('${teacherName}')">View Schedule</button>
                    </div>
                </div>
            `;
            
            // Insert after the teacher node
            teacherNode.parentNode.insertBefore(inlineInterface, teacherNode.nextSibling);
            
            // Scroll into view
            inlineInterface.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function openSubjectAssignmentModal(subjectName) {
            // Find the subject node and add inline assignment interface
            const subjectNode = document.querySelector(`[data-subject="${subjectName}"]`);
            if (!subjectNode) return;
            
            // Remove any existing inline interfaces
            document.querySelectorAll('.inline-assignment').forEach(el => el.remove());
            
            // Get subject's current assignments
            const subjectAssignments = {
                'Mathematics': ['Class 10A - Dr. Smith', 'Class 10B - Dr. Smith', 'Class 9A - Dr. Smith'],
                'Physics': ['Class 10A - Ms. Johnson', 'Class 9A - Ms. Johnson'],
                'English': ['Class 10A - Mr. Brown', 'Class 10B - Mr. Brown'],
                'Chemistry': ['Class 10B - Dr. Wilson']
            };
            
            const assignments = subjectAssignments[subjectName] || [];
            const unassignedClasses = ['Class 9A', 'Class 10B']; // Example unassigned classes
            
            // Create inline assignment interface
            const inlineInterface = document.createElement('div');
            inlineInterface.className = 'inline-assignment';
            inlineInterface.innerHTML = `
                <div class="inline-assignment-content">
                    <div class="inline-header">
                        <h4>${subjectName} - Manage Assignments</h4>
                        <button class="close-inline-btn" onclick="closeInlineAssignment()">&times;</button>
                    </div>
                    <div class="inline-assignments">
                        <label class="inline-label">Current Assignments:</label>
                        ${assignments.map(assignment => `
                            <div class="inline-assignment-item">
                                <span>${assignment}</span>
                                <button class="inline-reassign-btn" onclick="showInlineTeacherChange('${subjectName}', '${assignment}')">Change</button>
                            </div>
                        `).join('')}
                    </div>
                    ${unassignedClasses.length > 0 ? `
                    <div class="inline-unassigned">
                        <label class="inline-label">Quick Assign to Classes:</label>
                        ${unassignedClasses.map(className => `
                            <div class="inline-unassigned-item">
                                <span>${className}</span>
                                <div class="inline-form-row">
                                    <select class="inline-select" id="teacher-for-${className.replace(/\s+/g, '')}-${subjectName.replace(/\s+/g, '')}">
                                        <option value="">Select teacher...</option>
                                        <option value="Dr. Smith">Dr. Smith</option>
                                        <option value="Ms. Johnson">Ms. Johnson</option>
                                        <option value="Mr. Brown">Mr. Brown</option>
                                        <option value="Dr. Wilson">Dr. Wilson (Overloaded)</option>
                                    </select>
                                    <button class="inline-assign-btn" onclick="quickAssignInline('${subjectName}', '${className}')">Assign</button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    ` : ''}
                    <div class="inline-actions">
                        <button class="inline-schedule-btn" onclick="openScheduleModal('${subjectName}')">View Schedule Grid</button>
                    </div>
                </div>
            `;
            
            // Insert after the subject node
            subjectNode.parentNode.insertBefore(inlineInterface, subjectNode.nextSibling);
            
            // Scroll into view
            inlineInterface.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function openScheduleModal(name) {
            const modal = document.getElementById('schedule-modal');
            const title = document.getElementById('schedule-modal-title');
            
            title.textContent = `${name} - Schedule Grid`;
            modal.classList.add('active');
        }

        function closeAssignmentModal() {
            document.getElementById('assignment-modal').classList.remove('active');
        }

        function closeScheduleModal() {
            document.getElementById('schedule-modal').classList.remove('active');
        }

        function togglePeriod(cell, day, time) {
            if (cell.classList.contains('conflict')) {
                alert(`Conflict detected for ${day} ${time}. Please resolve conflicts first.`);
                return;
            }
            
            if (cell.classList.contains('assigned')) {
                cell.classList.remove('assigned');
                cell.classList.add('available');
            } else if (cell.classList.contains('available')) {
                cell.classList.remove('available');
                cell.classList.add('assigned');
            }
        }

        function saveSchedule() {
            alert('Schedule saved successfully!');
            closeScheduleModal();
        }

        function assignSubjectToTeacher(teacherName) {
            const select = document.getElementById('new-subject-select');
            const subject = select.value;
            
            if (subject) {
                alert(`${subject} assigned to ${teacherName}!`);
                closeAssignmentModal();
                // In real app, update the data and refresh the view
            } else {
                alert('Please select a subject first.');
            }
        }

        function closeInlineAssignment() {
            document.querySelectorAll('.inline-assignment').forEach(el => {
                el.style.animation = 'slideOutUp 0.2s ease-in';
                setTimeout(() => el.remove(), 200);
            });
        }

        function assignSubjectInline(teacherName) {
            const selectId = `inline-subject-${teacherName.replace(/\s+/g, '')}`;
            const select = document.getElementById(selectId);
            const subject = select.value;
            
            if (subject) {
                alert(`${subject} assigned to ${teacherName}!`);
                closeInlineAssignment();
                // In real app, update the data and refresh the view
            } else {
                alert('Please select a subject first.');
            }
        }

        function quickAssignInline(subjectName, className) {
            const selectId = `teacher-for-${className.replace(/\s+/g, '')}-${subjectName.replace(/\s+/g, '')}`;
            const select = document.getElementById(selectId);
            const teacher = select.value;
            
            if (teacher) {
                alert(`${subjectName} assigned to ${className} with ${teacher}!`);
                closeInlineAssignment();
                // In real app, update the data and refresh the view
            } else {
                alert('Please select a teacher first.');
            }
        }

        function showInlineReassign(teacherName, subject) {
            alert(`Reassigning ${subject} from ${teacherName}. Select new teacher.`);
            // In real app, show inline teacher selection
        }

        function showInlineTeacherChange(subjectName, assignment) {
            alert(`Changing teacher for ${assignment}. Select new teacher.`);
            // In real app, show inline teacher selection
        }

        function reassignSubject(teacherName, subject) {
            alert(`Reassigning ${subject} from ${teacherName}. Select new teacher.`);
            // In real app, show teacher selection modal
        }

        function reassignClass(subject, assignment) {
            alert(`Reassigning ${assignment}. Select new teacher.`);
            // In real app, show teacher selection modal
        }

        function quickAssignClass(subject, className) {
            alert(`Quick assigning ${subject} to ${className}. Selecting best available teacher.`);
            closeAssignmentModal();
            // In real app, use algorithm to find best teacher and assign
        }

        function assignSubject(className) {
            alert(`Assigning new subject to ${className}. Select subject and teacher.`);
            // In real app, show subject selection modal
        }

        function updateTeacherOptions(subjectSelect) {
            const subject = subjectSelect.value;
            const teacherSelect = subjectSelect.parentElement.querySelector('[id*="teacher-select"]');
            const assistantSelect = subjectSelect.parentElement.querySelector('[id*="assistant-select"]');
            
            // Clear previous options
            teacherSelect.innerHTML = '<option value="">Select Teacher...</option>';
            assistantSelect.innerHTML = '<option value="">Assistant...</option>';
            
            if (subject) {
                teacherSelect.disabled = false;
                assistantSelect.disabled = false;
                
                // Sample teacher data based on subject
                const teacherOptions = {
                    'Chemistry': [
                        { value: 'Dr. Wilson', text: 'Dr. Wilson (OVERLOADED +2)', class: 'overloaded' },
                        { value: 'Ms. Johnson', text: 'Ms. Johnson (Available)', class: 'available' }
                    ],
                    'Biology': [
                        { value: 'Dr. Wilson', text: 'Dr. Wilson (OVERLOADED +2)', class: 'overloaded' },
                        { value: 'Mr. Green', text: 'Mr. Green (Available)', class: 'available' }
                    ],
                    'History': [
                        { value: 'Ms. White', text: 'Ms. White (Available)', class: 'available' },
                        { value: 'Mr. Black', text: 'Mr. Black (Available)', class: 'available' }
                    ]
                };
                
                const assistantOptions = [
                    { value: 'Ms. Davis', text: 'Ms. Davis (Math Assistant)' },
                    { value: 'Mr. Taylor', text: 'Mr. Taylor (Science Assistant)' },
                    { value: 'Ms. Lee', text: 'Ms. Lee (Language Assistant)' }
                ];
                
                // Populate teacher options
                if (teacherOptions[subject]) {
                    teacherOptions[subject].forEach(teacher => {
                        const option = document.createElement('option');
                        option.value = teacher.value;
                        option.textContent = teacher.text;
                        if (teacher.class === 'overloaded') {
                            option.style.color = '#DC3545';
                            option.title = 'This teacher is overloaded';
                        }
                        teacherSelect.appendChild(option);
                    });
                }
                
                // Populate assistant options
                assistantOptions.forEach(assistant => {
                    const option = document.createElement('option');
                    option.value = assistant.value;
                    option.textContent = assistant.text;
                    assistantSelect.appendChild(option);
                });
            } else {
                teacherSelect.disabled = true;
                assistantSelect.disabled = true;
            }
        }

        // Contextual Grid View Functions
        let currentGridView = 'class';
        let currentSelection = 'Class 10A';

        function switchGridView(viewType) {
            // Update toggle buttons
            document.querySelectorAll('.view-type-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Hide all selection lists
            document.querySelectorAll('.selection-list').forEach(list => list.classList.remove('active'));
            
            // Show selected list
            document.getElementById(viewType + '-selection').classList.add('active');
            
            currentGridView = viewType;
            
            // Update context based on first item in the new view
            const firstItem = document.querySelector(`#${viewType}-selection .selection-item`);
            if (firstItem) {
                // Clear previous selections
                document.querySelectorAll('.selection-item').forEach(item => item.classList.remove('active'));
                firstItem.classList.add('active');
                
                // Get the selection name
                const selectionName = firstItem.querySelector('.item-title').textContent.trim();
                currentSelection = selectionName;
                updateContextColumns(viewType, selectionName);
            }
        }

        function selectGridItem(type, name, element) {
            // Clear previous selections in this list
            element.parentNode.querySelectorAll('.selection-item').forEach(item => item.classList.remove('active'));
            element.classList.add('active');
            
            currentSelection = name;
            updateContextColumns(type, name);
        }

        function updateContextColumns(type, selection) {
            const col2Title = document.getElementById('context-2-title');
            const col2Content = document.getElementById('context-2-content');
            const col3Title = document.getElementById('context-3-title');
            const col3Content = document.getElementById('context-3-content');
            const col4Title = document.getElementById('context-4-title');
            const col4Content = document.getElementById('context-4-content');
            const col5Title = document.getElementById('context-5-title');
            const col5Content = document.getElementById('context-5-content');

            if (type === 'class') {
                updateClassView(selection, col2Title, col2Content, col3Title, col3Content, col4Title, col4Content, col5Title, col5Content);
            } else if (type === 'subject') {
                updateSubjectView(selection, col2Title, col2Content, col3Title, col3Content, col4Title, col4Content, col5Title, col5Content);
            } else if (type === 'teacher') {
                updateTeacherView(selection, col2Title, col2Content, col3Title, col3Content, col4Title, col4Content, col5Title, col5Content);
            }
        }

        function updateClassView(className, col2Title, col2Content, col3Title, col3Content, col4Title, col4Content, col5Title, col5Content) {
            col2Title.textContent = `Subjects for ${className}`;
            col3Title.textContent = `${className} Schedule`;
            col4Title.textContent = 'Primary Teachers';
            col5Title.textContent = 'Assistant Teachers';

            // Sample data for Class 10A
            const classData = {
                'Class 10A': {
                    subjects: [
                        { name: 'Mathematics', teacher: 'Dr. Smith', assistant: 'Ms. Davis', time: 'Mon 9:00-10:00', status: 'assigned' },
                        { name: 'Physics', teacher: 'Ms. Johnson', assistant: 'Mr. Taylor', time: 'Tue 10:00-11:00', status: 'assigned' },
                        { name: 'English', teacher: 'Mr. Brown', assistant: null, time: 'Wed 11:00-12:00', status: 'assigned' }
                    ],
                    schedule: [
                        ['M', 'T', 'W', 'T', 'F'],
                        ['Math', '', 'Eng', '', 'Phy'],
                        ['', 'Phy', '', '', ''],
                        ['', '', 'Math', '', '']
                    ]
                },
                'Class 10B': {
                    subjects: [
                        { name: 'Mathematics', teacher: 'Dr. Smith', assistant: 'Ms. Davis', time: 'Mon 10:00-11:00', status: 'assigned' },
                        { name: 'Chemistry', teacher: 'Dr. Wilson', assistant: null, time: 'Thu 9:00-10:00', status: 'overloaded' },
                        { name: 'English', teacher: 'Mr. Brown', assistant: 'Ms. Lee', time: 'Fri 11:00-12:00', status: 'assigned' }
                    ],
                    schedule: [
                        ['M', 'T', 'W', 'T', 'F'],
                        ['', '', '', 'Chem', ''],
                        ['Math', '', '', '', 'Eng'],
                        ['', '', '', '', '']
                    ]
                },
                'Class 9A': {
                    subjects: [
                        { name: 'Mathematics', teacher: 'Dr. Smith', assistant: 'Ms. Davis', time: 'Tue 9:00-10:00', status: 'assigned' },
                        { name: 'Physics', teacher: 'Ms. Johnson', assistant: 'Mr. Taylor', time: 'Wed 10:00-11:00', status: 'assigned' }
                    ],
                    schedule: [
                        ['M', 'T', 'W', 'T', 'F'],
                        ['', 'Math', '', '', ''],
                        ['', '', 'Phy', '', ''],
                        ['', '', '', '', '']
                    ]
                }
            };

            const data = classData[className] || classData['Class 10A'];

            // Column 2: Subjects
            col2Content.innerHTML = data.subjects.map(subject => `
                <div class="context-item ${subject.status === 'overloaded' ? 'warning' : ''}">
                    <div class="context-item-title">
                        ${subject.name}
                        <span class="context-badge ${subject.status}">${subject.status === 'overloaded' ? 'Overloaded' : 'Assigned'}</span>
                    </div>
                    <div class="context-item-subtitle">${subject.teacher}${subject.assistant ? ' + ' + subject.assistant : ''}</div>
                    <div class="context-item-meta">
                        <span style="font-size: 11px; color: #7B54FA;">${subject.time}</span>
                    </div>
                </div>
            `).join('') + (className === 'Class 9A' ? `
                <div class="context-item" style="border: 2px dashed #FFC107; background: #FFF9E6;">
                    <div class="context-item-title">Add Subject</div>
                    <div class="context-item-subtitle">Click to assign new subject</div>
                </div>
            ` : '');

            // Column 3: Schedule Grid
            col3Content.innerHTML = `
                <div class="mini-schedule" style="grid-template-columns: repeat(5, 1fr); gap: 4px; margin-bottom: 16px;">
                    ${data.schedule.flat().map((cell, index) => {
                        if (index < 5) return `<div style="font-size: 10px; font-weight: 600; text-align: center; padding: 4px;">${cell}</div>`;
                        return `<div class="mini-schedule-cell ${cell ? 'assigned' : 'available'}" style="width: 100%; height: 24px; font-size: 10px;">${cell || ''}</div>`;
                    }).join('')}
                </div>
                <div style="font-size: 12px; color: #606060; margin-top: 12px;">
                    <strong>Legend:</strong> 
                    <span style="color: #7B54FA;">■ Assigned</span> | 
                    <span style="color: #E0E0E0;">□ Available</span>
                </div>
            `;

            // Column 4: Primary Teachers
            const teachers = [...new Set(data.subjects.map(s => s.teacher))];
            col4Content.innerHTML = teachers.map(teacher => `
                <div class="context-item">
                    <div class="context-item-title">
                        ${teacher}
                        <span class="teacher-badge pt">PT</span>
                    </div>
                    <div class="context-item-subtitle">${data.subjects.filter(s => s.teacher === teacher).map(s => s.name).join(', ')}</div>
                    <div class="context-item-meta">
                        <span class="context-badge ${teacher === 'Dr. Wilson' ? 'overloaded' : 'assigned'}">${teacher === 'Dr. Wilson' ? 'Overloaded' : 'Active'}</span>
                    </div>
                </div>
            `).join('');

            // Column 5: Assistant Teachers
            const assistants = data.subjects.filter(s => s.assistant).map(s => s.assistant);
            const uniqueAssistants = [...new Set(assistants)];
            col5Content.innerHTML = uniqueAssistants.map(assistant => `
                <div class="context-item">
                    <div class="context-item-title">
                        ${assistant}
                        <span class="teacher-badge at">AT</span>
                    </div>
                    <div class="context-item-subtitle">${data.subjects.filter(s => s.assistant === assistant).map(s => s.name).join(', ')}</div>
                    <div class="context-item-meta">
                        <span class="context-badge assigned">Active</span>
                    </div>
                </div>
            `).join('') + (uniqueAssistants.length < 3 ? `
                <div class="context-item" style="border: 2px dashed #28A745; background: #E8F5E8;">
                    <div class="context-item-title">Available Assistants</div>
                    <div class="context-item-subtitle">Ms. Lee, Mr. Taylor available</div>
                </div>
            ` : '');
        }

        function updateSubjectView(subjectName, col2Title, col2Content, col3Title, col3Content, col4Title, col4Content, col5Title, col5Content) {
            col2Title.textContent = `Classes for ${subjectName}`;
            col3Title.textContent = `${subjectName} Schedule Grid`;
            col4Title.textContent = 'Primary Teacher';
            col5Title.textContent = 'Available Teachers';

            const subjectData = {
                'Mathematics': {
                    classes: [
                        { name: 'Class 10A', students: 30, teacher: 'Dr. Smith', time: 'Mon 9:00-10:00' },
                        { name: 'Class 10B', students: 28, teacher: 'Dr. Smith', time: 'Mon 10:00-11:00' },
                        { name: 'Class 9A', students: 32, teacher: 'Dr. Smith', time: 'Tue 9:00-10:00' }
                    ],
                    primaryTeacher: 'Dr. Smith',
                    availableTeachers: ['Ms. Johnson', 'Mr. Brown']
                },
                'Physics': {
                    classes: [
                        { name: 'Class 10A', students: 30, teacher: 'Ms. Johnson', time: 'Tue 10:00-11:00' },
                        { name: 'Class 9A', students: 32, teacher: 'Ms. Johnson', time: 'Wed 10:00-11:00' }
                    ],
                    primaryTeacher: 'Ms. Johnson',
                    availableTeachers: ['Dr. Wilson', 'Mr. Taylor']
                }
            };

            const data = subjectData[subjectName] || subjectData['Mathematics'];

            // Column 2: Classes
            col2Content.innerHTML = data.classes.map(cls => `
                <div class="context-item">
                    <div class="context-item-title">
                        ${cls.name}
                        <span class="context-badge assigned">Assigned</span>
                    </div>
                    <div class="context-item-subtitle">${cls.students} students • ${cls.teacher}</div>
                    <div class="context-item-meta">
                        <span style="font-size: 11px; color: #7B54FA;">${cls.time}</span>
                    </div>
                </div>
            `).join('') + `
                <div class="context-item" style="border: 2px dashed #FFC107; background: #FFF9E6;">
                    <div class="context-item-title">Assign to Class</div>
                    <div class="context-item-subtitle">Class 10B available</div>
                </div>
            `;

            // Column 3: Schedule Grid
            col3Content.innerHTML = `
                <div class="mini-schedule" style="grid-template-columns: repeat(5, 1fr); gap: 4px;">
                    <div style="font-size: 10px; font-weight: 600; text-align: center; padding: 4px;">M</div>
                    <div style="font-size: 10px; font-weight: 600; text-align: center; padding: 4px;">T</div>
                    <div style="font-size: 10px; font-weight: 600; text-align: center; padding: 4px;">W</div>
                    <div style="font-size: 10px; font-weight: 600; text-align: center; padding: 4px;">T</div>
                    <div style="font-size: 10px; font-weight: 600; text-align: center; padding: 4px;">F</div>
                    <div class="mini-schedule-cell assigned" style="width: 100%; height: 24px;">10A</div>
                    <div class="mini-schedule-cell assigned" style="width: 100%; height: 24px;">9A</div>
                    <div class="mini-schedule-cell available" style="width: 100%; height: 24px;"></div>
                    <div class="mini-schedule-cell available" style="width: 100%; height: 24px;"></div>
                    <div class="mini-schedule-cell available" style="width: 100%; height: 24px;"></div>
                    <div class="mini-schedule-cell assigned" style="width: 100%; height: 24px;">10B</div>
                    <div class="mini-schedule-cell available" style="width: 100%; height: 24px;"></div>
                    <div class="mini-schedule-cell assigned" style="width: 100%; height: 24px;">9A</div>
                    <div class="mini-schedule-cell available" style="width: 100%; height: 24px;"></div>
                    <div class="mini-schedule-cell available" style="width: 100%; height: 24px;"></div>
                </div>
            `;

            // Column 4: Primary Teacher
            col4Content.innerHTML = `
                <div class="context-item selected">
                    <div class="context-item-title">
                        ${data.primaryTeacher}
                        <span class="teacher-badge pt">PT</span>
                    </div>
                    <div class="context-item-subtitle">${data.classes.length} classes assigned</div>
                    <div class="context-item-meta">
                        <span class="context-badge assigned">Primary</span>
                    </div>
                </div>
            `;

            // Column 5: Available Teachers
            col5Content.innerHTML = data.availableTeachers.map(teacher => `
                <div class="context-item">
                    <div class="context-item-title">
                        ${teacher}
                        <span class="teacher-badge pt">PT</span>
                    </div>
                    <div class="context-item-subtitle">Available for assignment</div>
                    <div class="context-item-meta">
                        <span class="context-badge available">Available</span>
                    </div>
                </div>
            `).join('');
        }

        function updateTeacherView(teacherName, col2Title, col2Content, col3Title, col3Content, col4Title, col4Content, col5Title, col5Content) {
            const isAssistant = teacherName.includes('Ms. Davis') || teacherName.includes('Mr. Taylor');
            
            col2Title.textContent = `Classes for ${teacherName}`;
            col3Title.textContent = `${teacherName} Schedule`;
            col4Title.textContent = 'Subjects';
            col5Title.textContent = isAssistant ? 'Primary Teachers' : 'Assistant Teachers';

            const teacherData = {
                'Dr. Smith': {
                    classes: [
                        { name: 'Class 10A', subject: 'Mathematics', time: 'Mon 9:00-10:00' },
                        { name: 'Class 10B', subject: 'Mathematics', time: 'Mon 10:00-11:00' },
                        { name: 'Class 9A', subject: 'Mathematics', time: 'Tue 9:00-10:00' }
                    ],
                    subjects: ['Mathematics'],
                    counterparts: [
                        { name: 'Ms. Davis', role: 'Math Assistant', type: 'assistant' }
                    ]
                },
                'Ms. Davis': {
                    classes: [
                        { name: 'Class 10A', subject: 'Mathematics', time: 'Mon 9:00-10:00' },
                        { name: 'Class 10B', subject: 'Mathematics', time: 'Mon 10:00-11:00' }
                    ],
                    subjects: ['Mathematics'],
                    counterparts: [
                        { name: 'Dr. Smith', role: 'Primary Math Teacher', type: 'primary' }
                    ]
                }
            };

            const data = teacherData[teacherName] || teacherData['Dr. Smith'];

            // Column 2: Classes
            col2Content.innerHTML = data.classes.map(cls => `
                <div class="context-item">
                    <div class="context-item-title">
                        ${cls.name}
                        <span class="context-badge assigned">Assigned</span>
                    </div>
                    <div class="context-item-subtitle">${cls.subject}</div>
                    <div class="context-item-meta">
                        <span style="font-size: 11px; color: #7B54FA;">${cls.time}</span>
                    </div>
                </div>
            `).join('');

            // Column 3: Schedule Grid
            col3Content.innerHTML = `
                <div class="mini-schedule" style="grid-template-columns: repeat(5, 1fr); gap: 4px;">
                    <div style="font-size: 10px; font-weight: 600; text-align: center; padding: 4px;">M</div>
                    <div style="font-size: 10px; font-weight: 600; text-align: center; padding: 4px;">T</div>
                    <div style="font-size: 10px; font-weight: 600; text-align: center; padding: 4px;">W</div>
                    <div style="font-size: 10px; font-weight: 600; text-align: center; padding: 4px;">T</div>
                    <div style="font-size: 10px; font-weight: 600; text-align: center; padding: 4px;">F</div>
                    <div class="mini-schedule-cell assigned" style="width: 100%; height: 24px;">10A</div>
                    <div class="mini-schedule-cell assigned" style="width: 100%; height: 24px;">9A</div>
                    <div class="mini-schedule-cell available" style="width: 100%; height: 24px;"></div>
                    <div class="mini-schedule-cell available" style="width: 100%; height: 24px;"></div>
                    <div class="mini-schedule-cell available" style="width: 100%; height: 24px;"></div>
                    <div class="mini-schedule-cell assigned" style="width: 100%; height: 24px;">10B</div>
                    <div class="mini-schedule-cell available" style="width: 100%; height: 24px;"></div>
                    <div class="mini-schedule-cell available" style="width: 100%; height: 24px;"></div>
                    <div class="mini-schedule-cell available" style="width: 100%; height: 24px;"></div>
                    <div class="mini-schedule-cell available" style="width: 100%; height: 24px;"></div>
                </div>
            `;

            // Column 4: Subjects
            col4Content.innerHTML = data.subjects.map(subject => `
                <div class="context-item">
                    <div class="context-item-title">
                        ${subject}
                        <span class="context-badge assigned">Teaching</span>
                    </div>
                    <div class="context-item-subtitle">${data.classes.length} classes</div>
                </div>
            `).join('');

            // Column 5: Counterparts
            col5Content.innerHTML = data.counterparts.map(counterpart => `
                <div class="counterpart-info">
                    <div class="counterpart-avatar ${counterpart.type === 'assistant' ? 'assistant' : ''}">
                        ${counterpart.type === 'assistant' ? 'AT' : 'PT'}
                    </div>
                    <div class="counterpart-details">
                        <div class="counterpart-name">${counterpart.name}</div>
                        <div class="counterpart-role">${counterpart.role}</div>
                    </div>
                </div>
            `).join('');
        }

        function toggleScheduleGrid() {
            const toggle = document.getElementById('schedule-grid-toggle');
            const scheduleColumn = document.getElementById('schedule-grid-column');
            const scheduleNodes = document.querySelectorAll('.schedule-grid-node');
            
            if (toggle.checked) {
                // Show schedule grid
                scheduleColumn.classList.remove('hidden');
                scheduleNodes.forEach(node => node.classList.add('expanded'));
            } else {
                // Hide schedule grid
                scheduleColumn.classList.add('hidden');
                scheduleNodes.forEach(node => node.classList.remove('expanded'));
            }
        }

        function assignInline(className) {
            const row = event.target.closest('.assignment-row');
            const selects = row.querySelectorAll('select');
            const subjectSelect = selects[0];
            const teacherSelect = selects[1];
            const assistantSelect = selects[2];
            
            const subject = subjectSelect.value;
            const teacher = teacherSelect.value;
            const assistant = assistantSelect.value;
            
            if (!subject || !teacher) {
                alert('Please select both subject and teacher');
                return;
            }
            
            const assistantText = assistant ? ` + ${assistant} (Assistant)` : '';
            alert(`Successfully assigned ${subject} with ${teacher}${assistantText} to ${className}!`);
            
            // In real app, this would update the data and refresh the view
            // For demo, we'll replace the assignment row with a regular subject item
            const newSubjectItem = document.createElement('li');
            newSubjectItem.className = 'subject-item';
            newSubjectItem.innerHTML = `
                <div class="subject-left">
                    <div class="subject-name">${subject}</div>
                    <div class="subject-meta">
                        <div class="time-slot">To be scheduled</div>
                    </div>
                </div>
                <div class="teacher-info">
                    <span class="teacher-name${teacher.includes('OVERLOADED') ? ' overloaded' : ''}">${teacher.split(' (')[0]}</span>
                    ${assistant ? `<span class="assistant-name">${assistant.split(' (')[0]}</span>` : '<span class="assistant-name unassigned">No Assistant</span>'}
                </div>
            `;
            
            row.parentNode.replaceChild(newSubjectItem, row);
        }

        // Initialize contextual grid view
        document.addEventListener('DOMContentLoaded', function() {
            if (document.getElementById('context-2-content')) {
                updateContextColumns('class', 'Class 10A');
            }
        });

        function assignToEmptyCell(cell, day, time) {
            // Remove any existing inline assignment
            document.querySelectorAll('.inline-schedule-assignment').forEach(el => el.remove());
            
            // Get available subjects (those not fully loaded)
            const availableSubjects = getAvailableSubjects();
            
            if (availableSubjects.length === 0) {
                alert('All subjects are fully assigned. No available subjects to assign.');
                return;
            }
            
            // Create inline assignment interface
            const inlineAssignment = document.createElement('div');
            inlineAssignment.className = 'inline-schedule-assignment';
            inlineAssignment.style.cssText = `
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: white;
                border: 2px solid #7B54FA;
                border-radius: 8px;
                padding: 12px;
                box-shadow: 0 4px 12px rgba(123, 84, 250, 0.2);
                z-index: 100;
                animation: slideInDown 0.2s ease-out;
            `;
            
            inlineAssignment.innerHTML = `
                <div style="font-size: 12px; font-weight: 600; color: #7B54FA; margin-bottom: 8px;">
                    Assign ${day} ${time}
                </div>
                <div style="margin-bottom: 8px;">
                    <select class="form-select" id="inline-subject-select" onchange="updateInlineTeacher()" style="width: 100%; padding: 6px; font-size: 12px; margin-bottom: 6px;">
                        <option value="">Select subject...</option>
                        ${availableSubjects.map(subject => `
                            <option value="${subject.name}" data-teacher="${subject.defaultTeacher}" data-assistant="${subject.defaultAssistant || ''}">
                                ${subject.name} (${subject.status})
                            </option>
                        `).join('')}
                    </select>
                    <div id="teacher-info" style="font-size: 11px; color: #606060; margin-bottom: 6px; min-height: 16px;"></div>
                </div>
                <div style="display: flex; gap: 6px;">
                    <button class="btn-secondary" onclick="cancelInlineScheduleAssignment()" style="flex: 1; padding: 6px; font-size: 12px;">Cancel</button>
                    <button class="btn-primary" onclick="confirmInlineScheduleAssignment('${day}', '${time}')" style="flex: 1; padding: 6px; font-size: 12px;">Assign</button>
                </div>
            `;
            
            // Position relative to the cell
            cell.style.position = 'relative';
            cell.appendChild(inlineAssignment);
            
            // Focus on the select
            setTimeout(() => {
                document.getElementById('inline-subject-select').focus();
            }, 100);
        }

        function getAvailableSubjects() {
            // Return subjects that are not fully loaded (need more class assignments)
            return [
                {
                    name: 'Physics',
                    status: 'Needs 1 more class',
                    defaultTeacher: 'Ms. Johnson',
                    defaultAssistant: 'Mr. Taylor'
                },
                {
                    name: 'English', 
                    status: 'Needs 1 more class',
                    defaultTeacher: 'Mr. Brown',
                    defaultAssistant: 'Ms. Lee'
                },
                {
                    name: 'Chemistry',
                    status: 'Critical - Teacher overloaded',
                    defaultTeacher: 'Dr. Wilson',
                    defaultAssistant: ''
                },
                {
                    name: 'Biology',
                    status: 'Available for assignment',
                    defaultTeacher: 'Dr. Wilson',
                    defaultAssistant: 'Mr. Taylor'
                }
            ];
        }

        function updateInlineTeacher() {
            const select = document.getElementById('inline-subject-select');
            const teacherInfo = document.getElementById('teacher-info');
            const selectedOption = select.options[select.selectedIndex];
            
            if (selectedOption.value) {
                const teacher = selectedOption.dataset.teacher;
                const assistant = selectedOption.dataset.assistant;
                const assistantText = assistant ? ` + ${assistant} (Assistant)` : ' (No assistant)';
                
                teacherInfo.innerHTML = `<strong>Auto-assigned:</strong> ${teacher}${assistantText}`;
                teacherInfo.style.color = teacher === 'Dr. Wilson' ? '#DC3545' : '#28A745';
            } else {
                teacherInfo.innerHTML = '';
            }
        }

        function confirmInlineScheduleAssignment(day, time) {
            const select = document.getElementById('inline-subject-select');
            const selectedOption = select.options[select.selectedIndex];
            
            if (!selectedOption.value) {
                alert('Please select a subject first.');
                return;
            }
            
            const subject = selectedOption.value;
            const teacher = selectedOption.dataset.teacher;
            const assistant = selectedOption.dataset.assistant;
            const assistantText = assistant ? ` + ${assistant}` : '';
            
            // Find the cell and update it
            const cell = document.querySelector('.inline-schedule-assignment').parentNode;
            cell.classList.remove('available');
            cell.classList.add('occupied');
            
            if (teacher === 'Dr. Wilson') {
                cell.classList.add('error');
            }
            
            cell.innerHTML = `
                <div class="cell-subject">${subject.substring(0, 4)}</div>
                <div class="cell-teacher">${teacher.split(' ')[1] || teacher}</div>
            `;
            
            cell.title = `${subject} - ${teacher}${assistantText}`;
            cell.onclick = () => editScheduleCell(cell);
            
            alert(`Successfully assigned ${subject} with ${teacher}${assistantText} for ${day} ${time}!`);
            
            // Remove the inline assignment
            cancelInlineScheduleAssignment();
        }

        function cancelInlineScheduleAssignment() {
            document.querySelectorAll('.inline-schedule-assignment').forEach(el => {
                el.style.animation = 'slideOutUp 0.2s ease-in';
                setTimeout(() => el.remove(), 200);
            });
        }

        function confirmAssignment(day, time) {
            const subject = document.getElementById('assign-subject').value;
            const teacher = document.getElementById('assign-teacher').value;
            const assistant = document.getElementById('assign-assistant').value;
            
            if (subject && teacher) {
                const assistantText = assistant ? ` + ${assistant}` : '';
                alert(`Assigned ${subject} with ${teacher}${assistantText} for ${day} ${time}!`);
                closeAssignmentModal();
                // In real app, update the schedule and refresh the view
            } else {
                alert('Please select both subject and teacher.');
            }
        }

        function reorganizeNetworkForSubject(subjectName) {
            const networkView = document.querySelector('.network-view');
            
            // Subject data for reorganization
            const subjectData = {
                'Mathematics': {
                    assignedClasses: ['Class 10A', 'Class 10B', 'Class 9A'],
                    unassignedClasses: [],
                    primaryTeacher: 'Dr. Smith',
                    availableTeachers: ['Ms. Johnson', 'Mr. Brown'],
                    assistants: ['Ms. Davis'],
                    availableAssistants: ['Mr. Taylor', 'Ms. Lee']
                },
                'Physics': {
                    assignedClasses: ['Class 10A', 'Class 9A'],
                    unassignedClasses: ['Class 10B'],
                    primaryTeacher: 'Ms. Johnson',
                    availableTeachers: ['Dr. Wilson', 'Mr. Brown'],
                    assistants: ['Mr. Taylor'],
                    availableAssistants: ['Ms. Davis', 'Ms. Lee']
                },
                'English': {
                    assignedClasses: ['Class 10A', 'Class 10B'],
                    unassignedClasses: ['Class 9A'],
                    primaryTeacher: 'Mr. Brown',
                    availableTeachers: ['Ms. Johnson', 'Dr. Wilson'],
                    assistants: ['Ms. Lee'],
                    availableAssistants: ['Ms. Davis', 'Mr. Taylor']
                },
                'Chemistry': {
                    assignedClasses: ['Class 10B'],
                    unassignedClasses: ['Class 10A', 'Class 9A'],
                    primaryTeacher: 'Dr. Wilson',
                    availableTeachers: ['Ms. Johnson'],
                    assistants: [],
                    availableAssistants: ['Ms. Davis', 'Mr. Taylor', 'Ms. Lee']
                }
            };

            const data = subjectData[subjectName] || subjectData['Mathematics'];
            
            // Create new network layout focused on the subject
            networkView.innerHTML = `
                <!-- Column 1: Selected Subject -->
                <div class="node-group">
                    <h3>Selected Subject</h3>
                    <div class="node selected subject-node" data-subject="${subjectName}">
                        <div class="node-title">${subjectName}</div>
                        <div class="node-subtitle">${data.assignedClasses.length} classes assigned</div>
                        <div class="node-info">${data.unassignedClasses.length > 0 ? `${data.unassignedClasses.length} more needed` : 'Fully assigned'}</div>
                    </div>
                </div>

                <!-- Column 2: Assigned Classes -->
                <div class="node-group">
                    <h3>Assigned Classes</h3>
                    ${data.assignedClasses.map(className => `
                        <div class="node" onclick="selectNode(this, 'class', '${className}')">
                            <div class="node-title">${className}</div>
                            <div class="node-subtitle">${className === 'Class 10A' ? '30' : className === 'Class 10B' ? '28' : '32'} Students</div>
                            <div class="node-info">Assigned</div>
                        </div>
                    `).join('')}
                    ${data.unassignedClasses.map(className => `
                        <div class="node unassigned" onclick="quickAssignSubjectToClass('${subjectName}', '${className}')" style="position: relative;" title="Click to assign ${subjectName} to ${className}">
                            <div class="warning-indicator">+</div>
                            <div class="node-title">${className}</div>
                            <div class="node-subtitle">${className === 'Class 10A' ? '30' : className === 'Class 10B' ? '28' : '32'} Students</div>
                            <div class="node-info">Click to assign</div>
                        </div>
                    `).join('')}
                </div>

                <!-- Column 3: Schedule Grid for Subject -->
                <div class="node-group schedule-grid-column" id="subject-schedule-grid">
                    <h3>${subjectName} Schedule</h3>
                    <div class="node schedule-grid-node expanded" onclick="openScheduleModal('${subjectName}')" style="cursor: pointer;">
                        <div class="node-title">Weekly Schedule</div>
                        <div class="mini-schedule-grid">
                            ${getSubjectScheduleGrid(subjectName)}
                        </div>
                        <div class="node-info">${data.assignedClasses.length} periods/week</div>
                    </div>
                    <div style="margin-top: 16px;">
                        <button class="quick-assign-btn" onclick="openScheduleModal('${subjectName}')" style="width: 100%;">Manage Schedule</button>
                    </div>
                </div>

                <!-- Column 4: Primary Teacher -->
                <div class="node-group">
                    <h3>Primary Teacher</h3>
                    <div class="node teacher-node selected" data-teacher="${data.primaryTeacher}" onclick="selectNode(this, 'teacher', '${data.primaryTeacher}')">
                        <div class="node-title">${data.primaryTeacher}</div>
                        <div class="node-subtitle">${subjectName} Teacher</div>
                        <div class="node-info">${data.assignedClasses.length} classes</div>
                    </div>
                    <div style="margin-top: 16px;">
                        <div style="font-size: 12px; font-weight: 600; color: #606060; margin-bottom: 8px;">Available Teachers:</div>
                        ${data.availableTeachers.map(teacher => `
                            <div class="node teacher-node underloaded" data-teacher="${teacher}" onclick="reassignSubjectTeacher('${subjectName}', '${teacher}')" style="position: relative; margin-bottom: 8px; cursor: pointer;" title="Click to assign ${teacher} to ${subjectName}">
                                <div class="warning-indicator">↔</div>
                                <div class="node-title" style="font-size: 12px;">${teacher}</div>
                                <div class="node-subtitle" style="font-size: 10px;">Available</div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <!-- Column 5: Assistant Teachers -->
                <div class="node-group">
                    <h3>Assistant Teachers</h3>
                    ${data.assistants.map(assistant => `
                        <div class="node teacher-node" data-teacher="${assistant}" onclick="selectNode(this, 'assistant', '${assistant}')">
                            <div class="node-title">${assistant}</div>
                            <div class="node-subtitle">${subjectName} Assistant</div>
                            <div class="node-info">Assigned</div>
                        </div>
                    `).join('')}
                    ${data.assistants.length === 0 ? `
                        <div class="node unassigned" style="position: relative;">
                            <div class="warning-indicator">!</div>
                            <div class="node-title">No Assistant</div>
                            <div class="node-subtitle">Needs assignment</div>
                            <div class="node-info">Critical</div>
                        </div>
                    ` : ''}
                    <div style="margin-top: 16px;">
                        <div style="font-size: 12px; font-weight: 600; color: #606060; margin-bottom: 8px;">Available Assistants:</div>
                        ${data.availableAssistants.map(assistant => `
                            <div class="node teacher-node underloaded" data-teacher="${assistant}" onclick="assignAssistantToSubject('${subjectName}', '${assistant}')" style="position: relative; margin-bottom: 8px; cursor: pointer;" title="Click to assign ${assistant} as assistant for ${subjectName}">
                                <div class="warning-indicator">+</div>
                                <div class="node-title" style="font-size: 12px;">${assistant}</div>
                                <div class="node-subtitle" style="font-size: 10px;">Available</div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <!-- Column 6: Quick Actions -->
                <div class="node-group">
                    <h3>Quick Actions</h3>
                    <div class="node" onclick="bulkAssignSubject('${subjectName}')" style="cursor: pointer; background: #E8F5E8; border-color: #28A745;">
                        <div class="node-title">Bulk Assign</div>
                        <div class="node-subtitle">All Classes</div>
                        <div class="node-info">Auto-assign</div>
                    </div>
                    <div class="node" onclick="optimizeSubjectSchedule('${subjectName}')" style="cursor: pointer; background: #F0EBFF; border-color: #7B54FA;">
                        <div class="node-title">Optimize</div>
                        <div class="node-subtitle">Schedule</div>
                        <div class="node-info">AI Suggest</div>
                    </div>
                    <div class="node" onclick="generateSubjectReport('${subjectName}')" style="cursor: pointer; background: #FFF9E6; border-color: #FFC107;">
                        <div class="node-title">Generate</div>
                        <div class="node-subtitle">Report</div>
                        <div class="node-info">Analytics</div>
                    </div>
                    <div class="node" onclick="resetSubjectView()" style="cursor: pointer; background: #F7F7F7; border-color: #606060;">
                        <div class="node-title">Reset View</div>
                        <div class="node-subtitle">Back to Default</div>
                        <div class="node-info">↺ Reset</div>
                    </div>
                </div>
            `;
        }

        function getSubjectScheduleGrid(subjectName) {
            const schedules = {
                'Mathematics': `
                    <div class="mini-grid-row">
                        <div class="mini-cell assigned" title="Mon 9:00 - Class 10A">M</div>
                        <div class="mini-cell assigned" title="Tue 9:00 - Class 9A">T</div>
                        <div class="mini-cell assigned" title="Wed 11:00 - Class 10A">W</div>
                        <div class="mini-cell available" title="Thu - Available">T</div>
                        <div class="mini-cell available" title="Fri - Available">F</div>
                    </div>
                    <div class="mini-grid-row">
                        <div class="mini-cell assigned" title="Mon 10:00 - Class 10B">M</div>
                        <div class="mini-cell available" title="Tue 10:00 - Available">T</div>
                        <div class="mini-cell available" title="Wed 10:00 - Available">W</div>
                        <div class="mini-cell available" title="Thu 10:00 - Available">T</div>
                        <div class="mini-cell available" title="Fri 10:00 - Available">F</div>
                    </div>
                `,
                'Physics': `
                    <div class="mini-grid-row">
                        <div class="mini-cell available" title="Mon - Available">M</div>
                        <div class="mini-cell assigned" title="Tue 10:00 - Class 10A">T</div>
                        <div class="mini-cell assigned" title="Wed 10:00 - Class 9A">W</div>
                        <div class="mini-cell available" title="Thu - Available">T</div>
                        <div class="mini-cell assigned" title="Fri 9:00 - Class 10A">F</div>
                    </div>
                    <div class="mini-grid-row">
                        <div class="mini-cell available" title="Mon 10:00 - Available">M</div>
                        <div class="mini-cell available" title="Tue 11:00 - Available">T</div>
                        <div class="mini-cell available" title="Wed 11:00 - Available">W</div>
                        <div class="mini-cell available" title="Thu 11:00 - Available">T</div>
                        <div class="mini-cell available" title="Fri 11:00 - Available">F</div>
                    </div>
                `,
                'English': `
                    <div class="mini-grid-row">
                        <div class="mini-cell assigned" title="Mon 11:00 - Class 10A">M</div>
                        <div class="mini-cell available" title="Tue - Available">T</div>
                        <div class="mini-cell assigned" title="Wed 9:00 - Class 10A">W</div>
                        <div class="mini-cell available" title="Thu - Available">T</div>
                        <div class="mini-cell assigned" title="Fri 11:00 - Class 10B">F</div>
                    </div>
                    <div class="mini-grid-row">
                        <div class="mini-cell available" title="Mon 10:00 - Available">M</div>
                        <div class="mini-cell available" title="Tue 11:00 - Available">T</div>
                        <div class="mini-cell available" title="Wed 11:00 - Available">W</div>
                        <div class="mini-cell available" title="Thu 11:00 - Available">T</div>
                        <div class="mini-cell available" title="Fri 10:00 - Available">F</div>
                    </div>
                `,
                'Chemistry': `
                    <div class="mini-grid-row">
                        <div class="mini-cell available" title="Mon - Available">M</div>
                        <div class="mini-cell available" title="Tue - Available">T</div>
                        <div class="mini-cell available" title="Wed - Available">W</div>
                        <div class="mini-cell conflict" title="Thu 10:00 - Class 10B (Dr. Wilson overloaded)">T</div>
                        <div class="mini-cell available" title="Fri - Available">F</div>
                    </div>
                    <div class="mini-grid-row">
                        <div class="mini-cell available" title="Mon 10:00 - Available">M</div>
                        <div class="mini-cell available" title="Tue 11:00 - Available">T</div>
                        <div class="mini-cell available" title="Wed 11:00 - Available">W</div>
                        <div class="mini-cell available" title="Thu 11:00 - Available">T</div>
                        <div class="mini-cell available" title="Fri 11:00 - Available">F</div>
                    </div>
                `
            };
            
            return schedules[subjectName] || schedules['Mathematics'];
        }

        function showConnections(type, name) {
            // Clear existing connection lines
            document.querySelectorAll('.connection-line').forEach(line => line.remove());
            
            // Highlight related nodes based on the selection
            if (type === 'class') {
                // Highlight subjects and teachers for this class
                highlightRelatedNodes(name);
            }
        }

        function highlightRelatedNodes(className) {
            // Sample data mapping - in real app, this would come from your data source
            const classSubjects = {
                'Class 10A': ['Mathematics', 'Physics', 'English'],
                'Class 10B': ['Mathematics', 'Chemistry', 'English'],
                'Class 9A': ['Mathematics', 'Physics']
            };

            const subjectTeachers = {
                'Mathematics': 'Dr. Smith',
                'Physics': 'Ms. Johnson',
                'English': 'Mr. Brown',
                'Chemistry': 'Dr. Wilson'
            };

            // Highlight subjects
            document.querySelectorAll('.subject-node').forEach(node => {
                const subject = node.dataset.subject;
                if (classSubjects[className] && classSubjects[className].includes(subject)) {
                    node.style.borderColor = '#7B54FA';
                    node.style.backgroundColor = '#F7F7F7';
                } else {
                    node.style.borderColor = '#E0E0E0';
                    node.style.backgroundColor = 'white';
                }
            });

            // Highlight teachers
            document.querySelectorAll('.teacher-node').forEach(node => {
                const teacher = node.dataset.teacher;
                const isAssigned = classSubjects[className] && 
                    classSubjects[className].some(subject => subjectTeachers[subject] === teacher);
                
                if (isAssigned) {
                    node.style.borderColor = '#7B54FA';
                    node.style.backgroundColor = '#F7F7F7';
                } else {
                    node.style.borderColor = '#E0E0E0';
                    node.style.backgroundColor = 'white';
                }
            });
        }

        function openModal(type) {
            document.getElementById('edit-modal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('edit-modal').classList.remove('active');
        }

        function editScheduleCell(cell) {
            if (cell.classList.contains('occupied')) {
                openModal('edit-schedule');
            } else {
                openModal('add-schedule');
            }
        }

        // Close modal when clicking outside
        document.getElementById('edit-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        document.getElementById('assignment-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeAssignmentModal();
            }
        });

        document.getElementById('schedule-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeScheduleModal();
            }
        });

        // Subject-focused action functions
        function quickAssignSubjectToClass(subjectName, className) {
            alert(`Quick assigning ${subjectName} to ${className}. Auto-selecting best available teacher and time slot.`);
            // In real app, this would use algorithm to find best teacher and time slot
            setTimeout(() => {
                alert(`✅ Successfully assigned ${subjectName} to ${className}!\n\nAuto-assigned:\n• Teacher: Best available\n• Time: Optimal slot\n• Assistant: If needed`);
                // Refresh the subject view
                reorganizeNetworkForSubject(subjectName);
            }, 1000);
        }

        function reassignSubjectTeacher(subjectName, newTeacher) {
            alert(`Reassigning ${subjectName} from current teacher to ${newTeacher}. This will update all classes.`);
            // In real app, this would update all class assignments for this subject
            setTimeout(() => {
                alert(`✅ Successfully reassigned ${subjectName} to ${newTeacher}!\n\nUpdated all class assignments automatically.`);
                reorganizeNetworkForSubject(subjectName);
            }, 1000);
        }

        function assignAssistantToSubject(subjectName, assistant) {
            alert(`Assigning ${assistant} as assistant teacher for ${subjectName}. This will apply to all classes.`);
            setTimeout(() => {
                alert(`✅ Successfully assigned ${assistant} as assistant for ${subjectName}!\n\nNow assisting in all ${subjectName} classes.`);
                reorganizeNetworkForSubject(subjectName);
            }, 1000);
        }

        function bulkAssignSubject(subjectName) {
            alert(`🤖 AI Bulk Assignment for ${subjectName}\n\nAnalyzing:\n• Available classes\n• Teacher workloads\n• Schedule conflicts\n• Student requirements\n\nProcessing...`);
            setTimeout(() => {
                alert(`✅ Bulk assignment complete for ${subjectName}!\n\n• Assigned to all required classes\n• Optimized teacher allocation\n• Resolved schedule conflicts\n• Added assistants where needed`);
                reorganizeNetworkForSubject(subjectName);
            }, 2000);
        }

        function optimizeSubjectSchedule(subjectName) {
            alert(`🧠 AI Schedule Optimization for ${subjectName}\n\nAnalyzing:\n• Current time slots\n• Teacher availability\n• Student preferences\n• Room availability\n\nOptimizing...`);
            setTimeout(() => {
                alert(`✅ Schedule optimized for ${subjectName}!\n\n• Reduced conflicts by 80%\n• Improved teacher efficiency\n• Better time distribution\n• Enhanced student experience`);
                openScheduleModal(subjectName);
            }, 2000);
        }

        function generateSubjectReport(subjectName) {
            alert(`📊 Generating comprehensive report for ${subjectName}...\n\nIncluding:\n• Assignment status\n• Teacher workload analysis\n• Schedule efficiency\n• Student coverage\n• Recommendations`);
            setTimeout(() => {
                alert(`✅ Report generated for ${subjectName}!\n\n📈 Key Insights:\n• 85% assignment efficiency\n• 2 optimization opportunities\n• 1 critical issue resolved\n• 3 improvement suggestions\n\n(In real app, this would open a detailed report)`);
            }, 1500);
        }

        function resetSubjectView() {
            // Reset to the original network view
            location.reload(); // Simple reset - in real app, would restore original layout
        }

        // Teacher view option switching
        function switchTeacherOption(option) {
            // Update option tabs
            document.querySelectorAll('#teacher-view .option-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            // Show/hide option content
            document.querySelectorAll('#teacher-view .option-content').forEach(content => content.classList.remove('active'));
            document.getElementById('teacher-' + option + '-option').classList.add('active');
        }

        // Subject view option switching
        function switchSubjectOption(option) {
            // Update option tabs
            document.querySelectorAll('#subject-view .option-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            // Show/hide option content
            document.querySelectorAll('#subject-view .option-content').forEach(content => content.classList.remove('active'));
            document.getElementById('subject-' + option + '-option').classList.add('active');
        }

        // Graph analytics functions
        function switchGraphType(type) {
            // Hide all graph views
            document.querySelectorAll('.graph-view').forEach(view => view.classList.remove('active'));
            
            // Show selected graph view
            document.getElementById(type + '-graph').classList.add('active');
        }

        function exportGraph() {
            alert('Graph exported successfully! (In real app, this would download the current graph as PNG/PDF)');
        }

        function exportTeacherSchedule() {
            alert('Teacher schedule exported successfully! (In real app, this would download as Excel/PDF)');
        }

        function optimizeAllSchedules() {
            alert('🤖 AI Schedule Optimization\n\nAnalyzing all teacher schedules...\n\nOptimization complete!\n• Reduced conflicts by 85%\n• Improved workload balance\n• Enhanced efficiency by 23%');
        }

        // Initialize with Class 10A selected
        document.addEventListener('DOMContentLoaded', function() {
            const firstClassNode = document.querySelector('.node');
            if (firstClassNode) {
                selectNode(firstClassNode, 'class', 'Class 10A');
            }
        });

        // Close inline assignment when clicking outside
        document.addEventListener('click', function(e) {
            const inlineAssignment = document.querySelector('.inline-assignment');
            if (inlineAssignment && !inlineAssignment.contains(e.target) && !e.target.closest('.node')) {
                closeInlineAssignment();
            }
            
            // Close inline schedule assignment when clicking outside
            const inlineScheduleAssignment = document.querySelector('.inline-schedule-assignment');
            if (inlineScheduleAssignment && !inlineScheduleAssignment.contains(e.target) && !e.target.closest('.schedule-cell')) {
                cancelInlineScheduleAssignment();
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96a7a934b5a36091',t:'MTc1NDQxMTIzNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
